!function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=34)}([function(e,t,n){var r,i;!function(o,a){"use strict";r=a,void 0!==(i="function"==typeof r?r.call(t,n,t,e):r)&&(e.exports=i)}(0,function(){"use strict";function e(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function t(t){return"debug"===t&&(t="log"),typeof console!==s&&(void 0!==console[t]?e(console,t):void 0!==console.log?e(console,"log"):a)}function n(e,t){for(var n=0;n<c.length;n++){var r=c[n];this[r]=n<e?a:this.methodFactory(r,e,t)}this.log=this.debug}function r(e,t,r){return function(){typeof console!==s&&(n.call(this,t,r),this[e].apply(this,arguments))}}function i(e,n,i){return t(e)||r.apply(this,arguments)}function o(e,t,r){function o(e){var t=(c[e]||"silent").toUpperCase();if(typeof window!==s){try{return void(window.localStorage[l]=t)}catch(e){}try{window.document.cookie=encodeURIComponent(l)+"="+t+";"}catch(e){}}}function a(){var e;if(typeof window!==s){try{e=window.localStorage[l]}catch(e){}if(typeof e===s)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(l)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===f.levels[e]&&(e=void 0),e}}var u,f=this,l="loglevel";e&&(l+=":"+e),f.name=e,f.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},f.methodFactory=r||i,f.getLevel=function(){return u},f.setLevel=function(t,r){if("string"==typeof t&&void 0!==f.levels[t.toUpperCase()]&&(t=f.levels[t.toUpperCase()]),!("number"==typeof t&&t>=0&&t<=f.levels.SILENT))throw"log.setLevel() called with invalid level: "+t;if(u=t,!1!==r&&o(t),n.call(f,t,e),typeof console===s&&t<f.levels.SILENT)return"No console available for logging"},f.setDefaultLevel=function(e){a()||f.setLevel(e,!1)},f.enableAll=function(e){f.setLevel(f.levels.TRACE,e)},f.disableAll=function(e){f.setLevel(f.levels.SILENT,e)};var d=a();null==d&&(d=null==t?"WARN":t),f.setLevel(d,!1)}var a=function(){},s="undefined",c=["trace","debug","info","warn","error"],u=new o,f={};u.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new o(e,u.getLevel(),u.methodFactory)),t};var l=typeof window!==s?window.log:void 0;return u.noConflict=function(){return typeof window!==s&&window.log===u&&(window.log=l),u},u.getLoggers=function(){return f},u})},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){return a.apply(this,arguments)}function a(){return a=i(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s(),!r.safari){e.next=5;break}setTimeout(function(){new Notification(t,{body:n.body})},500),e.next=7;break;case 5:return e.next=7,$mtsdk.pushNotifications.serviceWorkerRegistration.showNotification(t,n);case 7:case"end":return e.stop()}},e)})),a.apply(this,arguments)}function s(){return""===y.name&&""===y.version?y._detect(navigator.userAgent):y}function c(){return"https:"===location.protocol}function u(){return window.top===window.self}function f(){var e=s(),t=navigator.userAgent||"";if((e.chrome||e.chromium)&&!1===window.isSecureContext&&void 0===navigator.serviceWorker)return!0;if(e.firefox&&Number(e.version)<48&&(e.mobile||e.tablet))return!1;if(e.firefox&&Number(e.version)>=47){return!(["20160725105554","20160905130425","20161031153904","20161129180326","20161209150850","20170118123525","20170227085837","20170227131422","20170301181722","20170303022339","20170316213902","20170323110425","20170410145022","20170411115307","20170412142208","20170417065206","20170504112025","20170517122419","20170607123825","20170627155318","20170801170322","20170802111520","20170917103825","20170921064520","20171005074949","20171106172903","20171107091003","20171128121223","20171206101620","20171226003912","20180116134019","20180118122319","20180307131617","20180313134936","20180315163333","20180322140748","20180426000307","20180427183532","20180427222832","20180430140610","20180503092946","20180503164101","20180516032417","20180605153619","20180605174236","20180605201706","20180619102821","20180619173714","20180621064021","20180621121604","20180830204350","20180903060751","20180920175354","20181001135620","20181017185317","20181203164059","20190121141556","20190124141046","20190211182645"].indexOf(navigator.buildID)>-1)}return!(!e.safari&&void 0===navigator.serviceWorker)&&(!(e.ios||e.ipod||e.iphone||e.ipad)&&(!e.msie&&(!!(e.msedge&&Number(e.version)>=17.17063)||!(t.indexOf("FBAN")>-1||t.indexOf("FBAV")>-1)&&(!navigator.appVersion.match(/ wv/)&&(!!(e.safari&&Number(e.version)>=7.1)||(!!(e.samsungBrowser&&Number(e.version)>=4)||(!!((e.chrome||e.chromium)&&Number(e.version)>=54)||(!!(e.opera&&(e.mobile||e.tablet)&&Number(e.version)>=37||e.opera&&Number(e.version)>=42)||!!e.vivaldi))))))))}function l(){for(var e=0,t=document.domain,n=t.split("."),r="_gd"+(new Date).getTime();e<n.length-1&&-1===document.cookie.indexOf(r+"="+r);)t=n.slice(-1-++e).join("."),document.cookie=r+"="+r+";domain="+t+";";return document.cookie=r+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+t+";",t}function d(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n={apiKey:"AIzaSyBhpelizM8eTxeFrJScikFqsF319_b6SXM",authDomain:"copper-citron-121911.firebaseapp.com",databaseURL:"https://copper-citron-121911.firebaseio.com",storageBucket:"copper-citron-121911.appspot.com",messagingSenderId:"194501636895"};e=t?_.a.initializeApp(n,t):_.a.initializeApp(n);var r=_.a.messaging(e);return r.usePublicVapidKey($mtsdk.website.vapid_key),r}function h(e){var t=document.querySelectorAll(e);if(t.length>0)for(var n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n])}function p(e,t,n){if("string"==typeof e)document.querySelector(e).insertAdjacentHTML(t,n);else{if("object"!=typeof e)throw new Error("".concat(e," must be a CSS selector string or DOM Element object."));e.insertAdjacentHTML(t,n)}}function v(e,t){if("string"==typeof e)document.querySelector(e).classList.add(t);else{if("object"!=typeof e)throw new Error("".concat(e," must be a CSS selector string or DOM Element object."));e.classList.add(t)}}function m(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t||k.error("Cannot call on() with no event: ",t),n||k.error("Cannot call on() with no task: ",n),"string"==typeof e){var i=document.querySelectorAll(e);if(i.length>0)for(var o=0;o<i.length;o++)m(i[o],t,n)}else if(Array.isArray(e))for(var a=0;a<e.length;a++)m(e[a],t,n);else{if("object"!=typeof e)throw new Error("".concat(e," must be a CSS selector string or DOM Element object."));var s=function(){return function(t){var i=function(){e.removeEventListener(t.type,s)};r||i(),n(t,i)}}();e.addEventListener(t,s)}}function g(e,t){if(e.size!==t.size)return!1;var n=!0,r=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done);n=!0){var s=o.value;if(!t.has(s))return!1}}catch(e){r=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}return!0}function b(e,t){return JSON.stringify(e)===JSON.stringify(t)}t.l=o,t.e=c,t.g=u,t.f=f,t.c=l,t.d=d,t.j=h,t.b=p,t.a=v,t.i=m,t.k=g,t.h=b;var y=n(6),w=(n.n(y),n(68)),_=n.n(w),k=(n(70),n(27),n(0));n.n(k)},function(e,t,n){"use strict";t.a={env:"production",api:{base_url:"https://push.mxapis.com/api/",collect_url:"https://collect.mxapis.com/?v=1&s=web-push",assets_url:"https://assets.mxapis.com",safari_url:"https://apn.mxapis.com/api/safari"},worker:"/sw-mt.js",worker_options:{scope:"/"},debug:!1,proxy_frame_domain:"mxpush.com"}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return c});var a=n(12),s=n(2),c=function(){function e(){r(this,e)}return o(e,null,[{key:"getWindowEnv",value:function(){return"undefined"==typeof window?"undefined"!=typeof self&&void 0!==self.registration?a.d:a.g:window===window.top?location.pathname.includes("/subscribe")&&location.hostname.endsWith(s.a.proxy_frame_domain)?a.f:a.b:location.pathname.includes("/proxy-frame")?a.c:location.pathname.includes("/subscription-modal")?a.e:a.a}}]),e}()},function(e,t,n){(function(t){var n="object",r=function(e){return e&&e.Math==Math&&e};e.exports=r(typeof globalThis==n&&globalThis)||r(typeof window==n&&window)||r(typeof self==n&&self)||r(typeof t==n&&t)||Function("return this")()}).call(t,n(11))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){!function(t,r,i){void 0!==e&&e.exports?e.exports=i():n(61)("bowser",i)}(0,0,function(){function e(e){function t(t){var n=e.match(t);return n&&n.length>1&&n[1]||""}function n(t){var n=e.match(t);return n&&n.length>1&&n[2]||""}var i,o=t(/(ipod|iphone|ipad)/i).toLowerCase(),s=/like android/i.test(e),c=!s&&/android/i.test(e),u=/nexus\s*[0-6]\s*/i.test(e),f=!u&&/nexus\s*[0-9]+/i.test(e),l=/CrOS/.test(e),d=/silk/i.test(e),h=/sailfish/i.test(e),p=/tizen/i.test(e),v=/(web|hpw)(o|0)s/i.test(e),m=/windows phone/i.test(e),g=(/SamsungBrowser/i.test(e),!m&&/windows/i.test(e)),b=!o&&!d&&/macintosh/i.test(e),y=!c&&!h&&!p&&!v&&/linux/i.test(e),w=n(/edg([ea]|ios)\/(\d+(\.\d+)?)/i),_=t(/version\/(\d+(\.\d+)?)/i),k=/tablet/i.test(e)&&!/tablet pc/i.test(e),S=!k&&/[^-]mobi/i.test(e),E=/xbox/i.test(e);/opera/i.test(e)?i={name:"Opera",opera:a,version:_||t(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/opr\/|opios/i.test(e)?i={name:"Opera",opera:a,version:t(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i)||_}:/SamsungBrowser/i.test(e)?i={name:"Samsung Internet for Android",samsungBrowser:a,version:_||t(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)}:/Whale/i.test(e)?i={name:"NAVER Whale browser",whale:a,version:t(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)}:/MZBrowser/i.test(e)?i={name:"MZ Browser",mzbrowser:a,version:t(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/coast/i.test(e)?i={name:"Opera Coast",coast:a,version:_||t(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/focus/i.test(e)?i={name:"Focus",focus:a,version:t(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)}:/yabrowser/i.test(e)?i={name:"Yandex Browser",yandexbrowser:a,version:_||t(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?i={name:"UC Browser",ucbrowser:a,version:t(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?i={name:"Maxthon",maxthon:a,version:t(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?i={name:"Epiphany",epiphany:a,version:t(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?i={name:"Puffin",puffin:a,version:t(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?i={name:"Sleipnir",sleipnir:a,version:t(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?i={name:"K-Meleon",kMeleon:a,version:t(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:m?(i={name:"Windows Phone",osname:"Windows Phone",windowsphone:a},w?(i.msedge=a,i.version=w):(i.msie=a,i.version=t(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?i={name:"Internet Explorer",msie:a,version:t(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:l?i={name:"Chrome",osname:"Chrome OS",chromeos:a,chromeBook:a,chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/edg([ea]|ios)/i.test(e)?i={name:"Microsoft Edge",msedge:a,version:w}:/vivaldi/i.test(e)?i={name:"Vivaldi",vivaldi:a,version:t(/vivaldi\/(\d+(\.\d+)?)/i)||_}:h?i={name:"Sailfish",osname:"Sailfish OS",sailfish:a,version:t(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?i={name:"SeaMonkey",seamonkey:a,version:t(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(i={name:"Firefox",firefox:a,version:t(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(i.firefoxos=a,i.osname="Firefox OS")):d?i={name:"Amazon Silk",silk:a,version:t(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?i={name:"PhantomJS",phantom:a,version:t(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?i={name:"SlimerJS",slimer:a,version:t(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?i={name:"BlackBerry",osname:"BlackBerry OS",blackberry:a,version:_||t(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:v?(i={name:"WebOS",osname:"WebOS",webos:a,version:_||t(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(i.touchpad=a)):/bada/i.test(e)?i={name:"Bada",osname:"Bada",bada:a,version:t(/dolfin\/(\d+(\.\d+)?)/i)}:p?i={name:"Tizen",osname:"Tizen",tizen:a,version:t(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||_}:/qupzilla/i.test(e)?i={name:"QupZilla",qupzilla:a,version:t(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||_}:/chromium/i.test(e)?i={name:"Chromium",chromium:a,version:t(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||_}:/chrome|crios|crmo/i.test(e)?i={name:"Chrome",chrome:a,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:c?i={name:"Android",version:_}:/safari|applewebkit/i.test(e)?(i={name:"Safari",safari:a},_&&(i.version=_)):o?(i={name:"iphone"==o?"iPhone":"ipad"==o?"iPad":"iPod"},_&&(i.version=_)):i=/googlebot/i.test(e)?{name:"Googlebot",googlebot:a,version:t(/googlebot\/(\d+(\.\d+))/i)||_}:{name:t(/^(.*)\/(.*) /),version:n(/^(.*)\/(.*) /)},!i.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(i.name=i.name||"Blink",i.blink=a):(i.name=i.name||"Webkit",i.webkit=a),!i.version&&_&&(i.version=_)):!i.opera&&/gecko\//i.test(e)&&(i.name=i.name||"Gecko",i.gecko=a,i.version=i.version||t(/gecko\/(\d+(\.\d+)?)/i)),i.windowsphone||!c&&!i.silk?!i.windowsphone&&o?(i[o]=a,i.ios=a,i.osname="iOS"):b?(i.mac=a,i.osname="macOS"):E?(i.xbox=a,i.osname="Xbox"):g?(i.windows=a,i.osname="Windows"):y&&(i.linux=a,i.osname="Linux"):(i.android=a,i.osname="Android");var O="";i.windows?O=function(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}(t(/Windows ((NT|XP)( \d\d?.\d)?)/i)):i.windowsphone?O=t(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i.mac?(O=t(/Mac OS X (\d+([_\.\s]\d+)*)/i),O=O.replace(/[_\s]/g,".")):o?(O=t(/os (\d+([_\s]\d+)*) like mac os x/i),O=O.replace(/[_\s]/g,".")):c?O=t(/android[ \/-](\d+(\.\d+)*)/i):i.webos?O=t(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):i.blackberry?O=t(/rim\stablet\sos\s(\d+(\.\d+)*)/i):i.bada?O=t(/bada\/(\d+(\.\d+)*)/i):i.tizen&&(O=t(/tizen[\/\s](\d+(\.\d+)*)/i)),O&&(i.osversion=O);var P=!i.windows&&O.split(".")[0];return k||f||"ipad"==o||c&&(3==P||P>=4&&!S)||i.silk?i.tablet=a:(S||"iphone"==o||"ipod"==o||c||u||i.blackberry||i.webos||i.bada)&&(i.mobile=a),i.msedge||i.msie&&i.version>=10||i.yandexbrowser&&i.version>=15||i.vivaldi&&i.version>=1||i.chrome&&i.version>=20||i.samsungBrowser&&i.version>=4||i.whale&&1===r([i.version,"1.0"])||i.mzbrowser&&1===r([i.version,"6.0"])||i.focus&&1===r([i.version,"1.0"])||i.firefox&&i.version>=20||i.safari&&i.version>=6||i.opera&&i.version>=10||i.ios&&i.osversion&&i.osversion.split(".")[0]>=6||i.blackberry&&i.version>=10.1||i.chromium&&i.version>=20?i.a=a:i.msie&&i.version<10||i.chrome&&i.version<20||i.firefox&&i.version<20||i.safari&&i.version<6||i.opera&&i.version<10||i.ios&&i.osversion&&i.osversion.split(".")[0]<6||i.chromium&&i.version<20?i.c=a:i.x=a,i}function t(e){return e.split(".").length}function n(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n++)r.push(t(e[n]));return r}function r(e){for(var r=Math.max(t(e[0]),t(e[1])),i=n(e,function(e){var i=r-t(e);return e+=new Array(i+1).join(".0"),n(e.split("."),function(e){return new Array(20-e.length).join("0")+e}).reverse()});--r>=0;){if(i[0][r]>i[1][r])return 1;if(i[0][r]!==i[1][r])return-1;if(0===r)return 0}}function i(t,n,i){var o=s;"string"==typeof n&&(i=n,n=void 0),void 0===n&&(n=!1),i&&(o=e(i));var a=""+o.version;for(var c in t)if(t.hasOwnProperty(c)&&o[c]){if("string"!=typeof t[c])throw new Error("Browser version in the minVersion map should be a string: "+c+": "+String(t));return r([a,t[c]])<0}return n}function o(e,t,n){return!i(e,t,n)}var a=!0,s=e("undefined"!=typeof navigator?navigator.userAgent||"":"");return s.test=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("string"==typeof n&&n in s)return!0}return!1},s.isUnsupportedBrowser=i,s.compareVersions=r,s.check=o,s._detect=e,s.detect=e,s})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return h});var a=n(2),s=n(28),c=n.n(s),u=n(29),f=n(0),l=(n.n(f),n(66)),d=n(3),h=function(){function e(t,n,i){if(r(this,e),!window||!window.postMessage)throw new Error("Must pass in a valid window reference supporting postMessage():"+t);if(!n||!i)throw new Error("Invalid origin. Must be set.");this.windowReference=t,this.sendToOrigin=n,this.receiveFromOrigin=i,this._event=new c.a,this.channel=new MessageChannel,this.messagePort=null,this.isListening=!1,this.isConnected=!1,this.replies={}}return o(e,null,[{key:"HANDSHAKE_MESSAGE",get:function(){return"mtapis.postmam.handshake"}},{key:"CONNECTED_MESSAGE",get:function(){return"mtapis.postmam.connected"}},{key:"POSTMAM_COMMANDS",get:function(){return{CONNECTED:"connect",REMOTE_NOTIFICATION_PERMISSION:"postmam.remoteNotificationPermission",REMOTE_DATABASE_GET:"postmam.remoteDatabaseGet",REMOTE_DATABASE_PUT:"postmam.remoteDatabasePut",REMOTE_DATABASE_REMOVE:"postmam.remoteDatabaseRemove",REMOTE_OPERATION_COMPLETE:"postman.operationComplete",REMOTE_RETRIGGER_EVENT:"postmam.remoteRetriggerEvent",MODAL_LOADED:"postmam.modalPrompt.loaded",MODAL_PROMPT_ACCEPTED:"postmam.modalPrompt.accepted",MODAL_PROMPT_REJECTED:"postmam.modalPrompt.canceled",POPUP_LOADED:"postmam.popup.loaded",POPUP_ACCEPTED:"postmam.popup.accepted",POPUP_REJECTED:"postmam.popup.canceled",POPUP_CLOSING:"postman.popup.closing",REMOTE_NOTIFICATION_PERMISSION_CHANGED:"postmam.remoteNotificationPermissionChanged",IFRAME_POPUP_INITIALIZE:"postmam.iframePopupInitialize",UNSUBSCRIBE_FROM_PUSH:"postmam.unsubscribeFromPush",BEGIN_BROWSING_SESSION:"postmam.beginBrowsingSession",REQUEST_HOST_URL:"postmam.requestHostUrl",SHOW_HTTP_PERMISSION_REQUEST:"postmam.showHttpPermissionRequest",IS_SHOWING_HTTP_PERMISSION_REQUEST:"postmam.isShowingHttpPermissionRequest",WINDOW_TIMEOUT:"postmam.windowTimeout",FINISH_REMOTE_REGISTRATION:"postmam.finishRemoteRegistration",FINISH_REMOTE_REGISTRATION_IN_PROGRESS:"postmam.finishRemoteRegistrationInProgress",POPUP_BEGIN_MESSAGEPORT_COMMS:"postmam.beginMessagePortComms",SERVICEWORKER_COMMAND_REDIRECT:"postmam.command.redirect",HTTP_PERMISSION_REQUEST_RESUBSCRIBE:"postmam.httpPermissionRequestResubscribe",MARK_PROMPT_DISMISSED:"postmam.markPromptDismissed",IS_SUBSCRIBED:"postmam.isSubscribed",REMOTE_VISITOR_CHANGED:"postmam.rmeoteVisitorChanged",POPUP_LOAD_BODY:"postmam.popupLoadBody",SHOW_WELCOME:"postmam.showWelcome",CLOSE_POPUP:"postmam.closeWelcome"}}}]),o(e,[{key:"listen",value:function(){if(f.debug("(Postmam) Called listen()."),this.isListening)return void f.debug("(Postmam) Already listening for Postmam connections.");u.a.isBrowser()&&(this.isListening=!0,f.debug("(Postmam) Listening for Postmam connections.",this),window.addEventListener("message",this.onWindowMessagePostmanConnectReceived.bind(this)))}},{key:"startPostMessageReceive",value:function(){window.addEventListener("message",this.onWindowPostMessageReceived.bind(this))}},{key:"stopPostMessageReceive",value:function(){window.removeEventListener("message",this.onWindowPostMessageReceived)}},{key:"destroy",value:function(){this.stopPostMessageReceive(),this.removeEvent()}},{key:"onWindowPostMessageReceived",value:function(t){if(this.isSafeOrigin(t.origin)){var n=t.data,r=n.id,i=n.command,o=n.data,a=n.source;if(i===e.CONNECTED_MESSAGE)return this.emit("connect"),void(this.isConnected=!0);var s={id:r,command:i,data:o,source:a},c=Object.assign({reply:this.reply.bind(this,s)},s);if(this.replies.hasOwnProperty(r)){f.info("(Postmam) This message is a reply.");!1===this.replies[r].bind(window)(c)&&delete this.replies[r]}else this.emit(i,c)}}},{key:"onWindowMessagePostmanConnectReceived",value:function(t){if(f.debug("(Postmam) (".concat(d.a.getWindowEnv().toString(),") Window postmessage for Postman connect received:"),t),this.isSafeOrigin(t.origin)){t.data.handshake!==e.HANDSHAKE_MESSAGE?f.info("(Postmam) Got a postmam message, but not our expected handshake:",t.data):(f.info("(Postmam) Got our expected Postmam handshake message (and connecting...):",t.data),window.removeEventListener("message",this.onWindowMessagePostmanConnectReceived),this.messagePort=t.ports[0],this.messagePort.addEventListener("message",this.onMessageReceived.bind(this),!1),f.info("(Postmam) Removed previous message event listener for handshakes, replaced with main message listener."),this.messagePort.start(),this.isConnected=!0,f.info("(Postmam) (".concat(d.a.getWindowEnv().toString(),") Connected.")),this.message(e.CONNECTED_MESSAGE),this.emit("connect"))}}},{key:"connect",value:function(){f.info("(Postmam) (".concat(d.a.getWindowEnv().toString(),") Establishing a connection to ").concat(this.sendToOrigin,".")),this.messagePort=this.channel.port1,this.messagePort.addEventListener("message",this.onMessageReceived.bind(this),!1),this.messagePort.start(),this.windowReference.postMessage({handshake:e.HANDSHAKE_MESSAGE},this.sendToOrigin,[this.channel.port2])}},{key:"onMessageReceived",value:function(t){if(f.debug("(Postmam) (".concat(d.a.getWindowEnv().toString(),"):"),t.data),!t.data)return void f.debug("(".concat(d.a.getWindowEnv().toString(),") Received an empty Postmam message:"),t);var n=t.data,r=n.id,i=n.command,o=n.data,a=n.source;if(i===e.CONNECTED_MESSAGE)return this.emit("connect"),void(this.isConnected=!0);var s={id:r,command:i,data:o,source:a},c=Object.assign({reply:this.reply.bind(this,s)},s);if(this.replies.hasOwnProperty(r)){!1===this.replies[r].bind(window)(c)&&delete this.replies[r]}else this.emit(i,c)}},{key:"reply",value:function(e,t,n){var r={id:e.id,command:e.command,data:t,source:d.a.getWindowEnv().toString(),isReply:!0};"function"==typeof n&&(this.replies[r.id]=n),this.messagePort.postMessage(r)}},{key:"postMessage",value:function(e,t,n){if(!e||""==e)throw new Error("(Postmam) Postmam command must not be empty.");if("function"==typeof t)return void f.debug("You passed a function to data, did you mean to pass null?");var r={id:l.a.generate(),command:e,data:t,source:d.a.getWindowEnv().toString()};"function"==typeof n&&(this.replies[r.id]=n),this.windowReference.postMessage(r,"*")}},{key:"message",value:function(e,t,n){if(!e||""==e)throw new Error("(Postmam) Postmam command must not be empty.");if("function"==typeof t)return void f.debug("You passed a function to data, did you mean to pass null?");var r={id:l.a.generate(),command:e,data:t,source:d.a.getWindowEnv().toString()};"function"==typeof n&&(this.replies[r.id]=n),this.messagePort.postMessage(r)}},{key:"generateSafeOrigins",value:function(e){var t=[e];try{var n=new URL(e),r=n.host.replace("www.","");"https:"===n.protocol?(t.push("https://".concat(r)),t.push("https://www.".concat(r))):"http:"===n.protocol&&(t.push("http://".concat(r)),t.push("http://www.".concat(r)),t.push("https://".concat(r)),t.push("https://www.".concat(r)))}catch(e){}return t}},{key:"isSafeOrigin",value:function(e){var t=$mtsdk.website.http_domain||null,n=this.generateSafeOrigins(this.receiveFromOrigin);return e==="https://".concat(t||"",".").concat(a.a.proxy_frame_domain)||"*"===this.receiveFromOrigin||n.includes(e)}},{key:"on",value:function(){var e;return(e=this._event).on.apply(e,arguments)}},{key:"emit",value:function(){var e;return(e=this._event).emit.apply(e,arguments)}},{key:"once",value:function(){var e;return(e=this._event).once.apply(e,arguments)}}]),e}()},function(e,t,n){var r=n(5);e.exports=!r(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";function r(e,t){function n(){this.constructor=e}_(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function i(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]]);return n}function o(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function a(e,t){return function(n,r){t(n,r,e)}}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function c(e,t,n,r){return new(n||(n=Promise))(function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function s(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(a,s)}c((r=r.apply(e,t||[])).next())})}function u(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,o&&(a=2&n[0]?o.return:n[0]?o.throw||((a=o.return)&&a.call(o),0):o.next)&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}function f(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}function l(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function d(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(d(arguments[t]));return e}function p(e){return this instanceof p?(this.v=e,this):new p(e)}function v(e,t,n){function r(e){f[e]&&(u[e]=function(t){return new Promise(function(n,r){l.push([e,t,n,r])>1||i(e,t)})})}function i(e,t){try{o(f[e](t))}catch(e){c(l[0][3],e)}}function o(e){e.value instanceof p?Promise.resolve(e.value.v).then(a,s):c(l[0][2],e)}function a(e){i("next",e)}function s(e){i("throw",e)}function c(e,t){e(t),l.shift(),l.length&&i(l[0][0],l[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,f=n.apply(e,t||[]),l=[];return u={},r("next"),r("throw"),r("return"),u[Symbol.asyncIterator]=function(){return this},u}function m(e){function t(t,i){n[t]=e[t]?function(n){return(r=!r)?{value:p(e[t](n)),done:"return"===t}:i?i(n):n}:i}var n,r;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n}function g(e){function t(t){r[t]=e[t]&&function(r){return new Promise(function(i,o){r=e[t](r),n(i,o,r.done,r.value)})}}function n(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e[Symbol.asyncIterator];return i?i.call(e):(e="function"==typeof l?l(e):e[Symbol.iterator](),r={},t("next"),t("throw"),t("return"),r[Symbol.asyncIterator]=function(){return this},r)}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function y(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function w(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.__extends=r,n.d(t,"__assign",function(){return k}),t.__rest=i,t.__decorate=o,t.__param=a,t.__metadata=s,t.__awaiter=c,t.__generator=u,t.__exportStar=f,t.__values=l,t.__read=d,t.__spread=h,t.__await=p,t.__asyncGenerator=v,t.__asyncDelegator=m,t.__asyncValues=g,t.__makeTemplateObject=b,t.__importStar=y,t.__importDefault=w;var _=function(e,t){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},k=function(){return k=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},k.apply(this,arguments)}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"f",function(){return o}),n.d(t,"e",function(){return a}),n.d(t,"a",function(){return s}),n.d(t,"g",function(){return c}),n.d(t,"c",function(){return u});var r="ServiceWorker",i="Host",o="Popup",a="Modal",s="CustomFrame",c="Unknown",u="ProxyFrame"},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return v});var c=n(0),u=(n.n(c),n(3)),f=n(12),l=n(6),d=(n.n(l),n(7)),h=n(14),p=n(1),v=function(){function e(){o(this,e)}return s(e,null,[{key:"getFirebaseToken",value:function(){return new Promise(function(e){return $mtsdk.firebaseMessaging||($mtsdk.firebaseMessaging=p.d("mt-firebase-app"),$mtsdk.serviceWorkerRegistration||e(null),$mtsdk.firebaseMessaging.useServiceWorker($mtsdk.serviceWorkerRegistration)),$mtsdk.firebaseMessaging.getToken().then(function(t){e(t)}).catch(function(t){e(null)})})}},{key:"subscribeForPush",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r,i,o,a,s,l,p,v;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return $mtsdk.serviceWorkerRegistration=n,t.next=3,e.getNotificationPermission();case 3:if((r=t.sent)===h.c){t.next=7;break}return c.warn("Subscribe permission not granted"),t.abrupt("return");case 7:return t.next=9,e.getFirebaseToken();case 9:return i=t.sent,t.next=12,n.pushManager.getSubscription();case 12:if(o=t.sent,a={fcmToken:i},a.vapidKey=$mtsdk.website.vapid_key,o){if(void 0!==o.subscriptionId?a.endpoint=o.subscriptionId:a.endpoint=o.endpoint,o.getKey){s=null;try{s=o.getKey("p256dh")}catch(e){}l=null;try{l=o.getKey("auth")}catch(e){}s&&(p=btoa(String.fromCharCode.apply(null,new Uint8Array(s))),a.p256dh=p),l&&(v=btoa(String.fromCharCode.apply(null,new Uint8Array(l))),a.auth=v)}}else c.warn("Could not subscribe your browser for push notifications.");if(u.a.getWindowEnv()!==f.f){t.next=21;break}return t.next=19,$mtsdk.subscriptionPopup.message(d.a.POSTMAM_COMMANDS.FINISH_REMOTE_REGISTRATION,{subscriptionInfo:a},function(e){!0===e.data.progress?c.debug("Got message from host page that remote reg. is in progress, closing popup."):c.debug("Got message from host page that remote reg. could not be finished.")});case 19:t.next=22;break;case 21:c.debug("@todo subscribe native https");case 22:case"end":return t.stop()}},t)}));return t}()},{key:"enableNotifications",value:function(t){return c.debug("Called enableNotifications()"),"PushManager"in window?"denied"===window.Notification.permission?void c.warn("The user has blocked notifications."):(c.debug("Calling navigator.serviceWorker.ready() ..."),void navigator.serviceWorker.ready.then(function(t){c.debug("Finished calling navigator.serviceWorker.ready"),e.subscribeForPush(t)})):void c.info("Push messaging is not supported. No PushManager.")}},{key:"hasInsecureParentOrigin",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(window!==window.top&&"serviceWorker"in navigator&&void 0!==navigator.serviceWorker.getRegistration){e.next=2;break}return e.abrupt("return",!1);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.getRegistration();case 5:return e.abrupt("return",!1);case 8:return e.prev=8,e.t0=e.catch(2),e.abrupt("return",!0);case 11:case"end":return e.stop()}},e,null,[[2,8]])}));return e}()},{key:"isUsingSubscriptionWorkaround",value:function(){return!l.safari&&(u.a.getWindowEnv()===f.b&&!$mtsdk.website.https_enabled&&"string"==typeof $mtsdk.website.http_domain&&$mtsdk.website.http_domain.length>0)}},{key:"getNotificationPermission",value:function(){function t(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isUsingSubscriptionWorkaround()||!p.g()){t.next=9;break}return t.next=3,$mtsdk.visitor.ready;case 3:if(n=t.sent,!n.firebaseToken||n.notificationPermission){t.next=6;break}return t.abrupt("return",h.c);case 6:return t.abrupt("return",n.notificationPermission||h.a);case 9:return t.abrupt("return",window.Notification.permission);case 10:case"end":return t.stop()}},t)}));return t}()},{key:"getSafariNotificationPermission",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.safari.pushNotification.permission(t).permission);case 1:case"end":return e.stop()}},e)}));return e}()},{key:"getSafariNotificationData",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",window.safari.pushNotification.permission(t));case 1:case"end":return e.stop()}},e)}));return e}()},{key:"subscribeSafariPromptPermission",value:function(){return new Promise(function(e){window.safari.pushNotification.requestPermission($mtsdk.config.api.safari_url,$mtsdk.website.safariWebId,{websiteId:$mtsdk.website.id,userId:$mtsdk.visitor.uid},function(t){e(t)})})}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"c",function(){return i}),n.d(t,"b",function(){return o});var r="default",i="granted",o="denied"},function(e,t,n){"use strict";var r=n(4),i=n(37).f,o=n(41),a=n(42),s=n(43),c=n(23),u=n(21),f=function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t};e.exports=function(e,t){var n,l,d,h,p,v,m,g,b,y=e.target,w=e.global,_=e.stat,k=e.proto,S=w?r:_?r[y]:(r[y]||{}).prototype,E=w?a:a[y]||(a[y]={}),O=E.prototype;for(h in t)n=o(w?h:y+(_?".":"#")+h,e.forced),l=!n&&S&&u(S,h),v=E[h],l&&(e.noTargetGet?(b=i(S,h),m=b&&b.value):m=S[h]),p=l&&m?m:t[h],l&&typeof v==typeof p||(g=e.bind&&l?s(p,r):e.wrap&&l?f(p):k&&"function"==typeof p?s(Function.call,p):p,(e.sham||p&&p.sham||v&&v.sham)&&c(g,"sham",!0),E[h]=g,k&&(d=y+"Prototype",u(a,d)||c(a,d,{}),a[d][h]=p,e.real&&O&&!O[h]&&c(O,h,p)))}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(39),i=n(19);e.exports=function(e){return r(i(e))}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){var r=n(9);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(8),i=n(5),o=n(40);e.exports=!r&&!i(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var r=n(8),i=n(45),o=n(16);e.exports=r?function(e,t,n){return i.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(4),i=n(54),o=n(57),a=n(58),s=r.Symbol,c=i("wks");e.exports=function(e){return c[e]||(c[e]=a&&s[e]||(a?s:o)("Symbol."+e))}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return s});var a=n(2),s=function(){function e(){r(this,e)}return o(e,null,[{key:"buildUrl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.baseUrl;t.ts=Math.floor((new Date).getTime()/1e3);for(var r=[],i=0,o=Object.keys(t);i<o.length;i++){var a=o[i];r.push(a+"="+t[a])}return n+"&"+r.join("&")}},{key:"baseUrl",get:function(){return a.a.api.collect_url}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?o(e):t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(63),f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"MTSDK: Init error";return r(this,t),i(this,a(t).call(this,e))}return s(t,e),t}(u.a);t.a=f},function(e,t,n){var r;!function(t){"use strict";function i(){}function o(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}function a(e){return function(){return this[e].apply(this,arguments)}}function s(e){return"function"==typeof e||e instanceof RegExp||!(!e||"object"!=typeof e)&&s(e.listener)}var c=i.prototype,u=t.EventEmitter;c.getListeners=function(e){var t,n,r=this._getEvents();if(e instanceof RegExp){t={};for(n in r)r.hasOwnProperty(n)&&e.test(n)&&(t[n]=r[n])}else t=r[e]||(r[e]=[]);return t},c.flattenListeners=function(e){var t,n=[];for(t=0;t<e.length;t+=1)n.push(e[t].listener);return n},c.getListenersAsObject=function(e){var t,n=this.getListeners(e);return n instanceof Array&&(t={},t[e]=n),t||n},c.addListener=function(e,t){if(!s(t))throw new TypeError("listener must be a function");var n,r=this.getListenersAsObject(e),i="object"==typeof t;for(n in r)r.hasOwnProperty(n)&&-1===o(r[n],t)&&r[n].push(i?t:{listener:t,once:!1});return this},c.on=a("addListener"),c.addOnceListener=function(e,t){return this.addListener(e,{listener:t,once:!0})},c.once=a("addOnceListener"),c.defineEvent=function(e){return this.getListeners(e),this},c.defineEvents=function(e){for(var t=0;t<e.length;t+=1)this.defineEvent(e[t]);return this},c.removeListener=function(e,t){var n,r,i=this.getListenersAsObject(e);for(r in i)i.hasOwnProperty(r)&&-1!==(n=o(i[r],t))&&i[r].splice(n,1);return this},c.off=a("removeListener"),c.addListeners=function(e,t){return this.manipulateListeners(!1,e,t)},c.removeListeners=function(e,t){return this.manipulateListeners(!0,e,t)},c.manipulateListeners=function(e,t,n){var r,i,o=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!=typeof t||t instanceof RegExp)for(r=n.length;r--;)o.call(this,t,n[r]);else for(r in t)t.hasOwnProperty(r)&&(i=t[r])&&("function"==typeof i?o.call(this,r,i):a.call(this,r,i));return this},c.removeEvent=function(e){var t,n=typeof e,r=this._getEvents();if("string"===n)delete r[e];else if(e instanceof RegExp)for(t in r)r.hasOwnProperty(t)&&e.test(t)&&delete r[t];else delete this._events;return this},c.removeAllListeners=a("removeEvent"),c.emitEvent=function(e,t){var n,r,i,o,a=this.getListenersAsObject(e);for(o in a)if(a.hasOwnProperty(o))for(n=a[o].slice(0),i=0;i<n.length;i++)r=n[i],!0===r.once&&this.removeListener(e,r.listener),r.listener.apply(this,t||[])===this._getOnceReturnValue()&&this.removeListener(e,r.listener);return this},c.trigger=a("emitEvent"),c.emit=function(e){var t=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,t)},c.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},c._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},c._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return t.EventEmitter=u,i},void 0!==(r=function(){return i}.call(t,n,t,e))&&(e.exports=r)}("undefined"!=typeof window?window:this||{})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return c});var a=n(6),s=n.n(a),c=function(){function e(){r(this,e)}return o(e,null,[{key:"isBrowser",value:function(){return"undefined"!=typeof window}},{key:"isSafari",value:function(){return e.isBrowser()&&s.a.safari}},{key:"supportsServiceWorkers",value:function(){return"undefined"!=typeof navigator&&"serviceWorker"in navigator}}]),e}()},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function i(e){function t(e){s(f[e],"delete"),delete f[e]}function n(e){if(e=e||d,!r(f,e))throw l.create("no-app",{name:e});return f[e]}function i(t,n){if(void 0===n&&(n={}),"object"!=typeof n||null===n){n={name:n}}var i=n;void 0===i.name&&(i.name=d);var o=i.name;if("string"!=typeof o||!o)throw l.create("bad-app-name",{name:String(o)});if(r(f,o))throw l.create("duplicate-app",{name:o});var a=new e(t,i,m);return f[o]=a,s(a,"create"),a}function o(){return Object.keys(f).map(function(e){return f[e]})}function a(t,r,i,a,s){function u(e){if(void 0===e&&(e=n()),"function"!=typeof e[t])throw l.create("invalid-app-argument",{name:t});return e[t]()}if(void 0===s&&(s=!1),h[t])throw l.create("duplicate-service",{name:t});return h[t]=r,a&&(p[t]=a,o().forEach(function(e){a("create",e)})),void 0!==i&&c.deepExtend(u,i),m[t]=u,e.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,t).apply(this,s?e:[])},u}function s(e,t){for(var n=0,r=Object.keys(h);n<r.length;n++){var i=r[n],o=u(e,i);if(null===o)return;p[o]&&p[o](t,e)}}function u(e,t){return"serverAuth"===t?null:t}var f={},h={},p={},m={__esModule:!0,initializeApp:i,app:n,apps:null,SDK_VERSION:v,INTERNAL:{registerService:a,removeApp:t,factories:h,useAsService:u}};return c.patchProperty(m,"default",m),Object.defineProperty(m,"apps",{get:o}),c.patchProperty(n,"App",e),m}function o(){function e(e){c.deepExtend(t,e)}var t=i(p);return t.INTERNAL=s.__assign({},t.INTERNAL,{createFirebaseNamespace:o,extendNamespace:e,createSubscribe:c.createSubscribe,ErrorFactory:c.ErrorFactory,deepExtend:c.deepExtend}),t}Object.defineProperty(t,"__esModule",{value:!0});var a,s=n(10),c=n(31),u=n(69),f=(a={},a["no-app"]="No Firebase App '{$name}' has been created - call Firebase App.initializeApp()",a["bad-app-name"]="Illegal App name: '{$name}",a["duplicate-app"]="Firebase App named '{$name}' already exists",a["app-deleted"]="Firebase App named '{$name}' already deleted",a["duplicate-service"]="Firebase service named '{$name}' already registered",a["invalid-app-argument"]="firebase.{$name}() takes either no argument or a Firebase App instance.",a),l=new c.ErrorFactory("app","Firebase",f),d="[DEFAULT]",h=[],p=function(){function e(e,t,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=c.deepCopy(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){h.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){h=h.filter(function(t){return t!==e})}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){e.firebase_.INTERNAL.removeApp(e.name_);for(var t=[],n=0,r=Object.keys(e.services_);n<r.length;n++)for(var i=r[n],o=0,a=Object.keys(e.services_[i]);o<a.length;o++){var s=a[o];t.push(e.services_[i][s])}return Promise.all(t.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=!0,e.services_={}})},e.prototype._getService=function(e,t){if(void 0===t&&(t=d),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][t]){var n=t!==d?t:void 0,r=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),n);this.services_[e][t]=r}return this.services_[e][t]},e.prototype.extendApp=function(e){var t=this;c.deepExtend(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(h.forEach(function(e){t.INTERNAL.addAuthTokenListener(e)}),h=[])},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{name:this.name_})},e}();p.prototype.name&&p.prototype.options||p.prototype.delete||console.log("dc");var v="6.0.4",m=new u.Logger("@firebase/app");if(c.isBrowser()&&"firebase"in self){m.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var g=self.firebase.SDK_VERSION;g&&g.indexOf("LITE")>=0&&m.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var b=o(),y=b.initializeApp;b.initializeApp=function(){return c.isNode()&&m.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and set "module"\n      to false and "main" to true:\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),y.apply(void 0,arguments)};var w=b;t.default=w,t.firebase=w},function(e,t,n){"use strict";(function(e){function r(e){return i(void 0,e)}function i(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:var n=t;return new Date(n.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r in t)t.hasOwnProperty(r)&&(e[r]=i(e[r],t[r]));return e}function o(e,t,n){e[t]=n}function a(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function s(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(a())}function c(){try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(e){return!1}}function u(){return"object"==typeof self&&self.self===self}function f(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function l(){return!0===E.NODE_CLIENT||!0===E.NODE_ADMIN}function d(e,t){return e.replace(D,function(e,n){var r=t[n];return null!=r?r.toString():"<"+n+"?>"})}function h(e){return JSON.parse(e)}function p(e){return JSON.stringify(e)}function v(e,t){var n=new oe(e,t);return n.subscribe.bind(n)}function m(e,t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){e.apply(void 0,n)}).catch(function(e){t&&t(e)})}}function g(e,t){if("object"!=typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return!0}return!1}function b(){}function y(e,t,n){var r="";switch(t){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=e+" failed: ";return i+=r+" argument "}function w(e,t,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(y(e,t,r)+"must be a valid firebase namespace.")}function _(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(y(e,t,r)+"must be a valid function.")}function k(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(y(e,t,r)+"must be a valid context object.")}Object.defineProperty(t,"__esModule",{value:!0});var S=n(10),E={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},O=function(e,t){if(!e)throw P(t)},P=function(e){return new Error("Firebase Database ("+E.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},T=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},I=function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var o=e[n++],a=e[n++],s=e[n++],c=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&s)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(1023&c))}else{var o=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return t.join("")},N={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,f=o>>2,l=(3&o)<<4|s>>4,d=(15&s)<<2|u>>6,h=63&u;c||(h=64,a||(d=64)),r.push(n[f],n[l],n[d],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(T(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):I(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length,s=a?n[e.charAt(i)]:0;++i;var c=i<e.length,u=c?n[e.charAt(i)]:64;++i;var f=i<e.length,l=f?n[e.charAt(i)]:64;if(++i,null==o||null==s||null==u||null==l)throw Error();var d=o<<2|s>>4;if(r.push(d),64!=u){var h=s<<4&240|u>>2;if(r.push(h),64!=l){var p=u<<6&192|l;r.push(p)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},C=function(e){var t=T(e);return N.encodeByteArray(t,!0)},R=function(e){try{return N.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},x=function(){function e(){var e=this;this.promise=new Promise(function(t,n){e.resolve=t,e.reject=n})}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"==typeof e&&(t.promise.catch(function(){}),1===e.length?e(n):e(n,r))}},e}(),A="FirebaseError",M=function(e){function t(n,r){var i=e.call(this,r)||this;return i.code=n,i.name=A,Object.setPrototypeOf(i,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,j.prototype.create),i}return S.__extends(t,e),t}(Error),j=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?d(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",c=new M(i,s),u=0,f=Object.keys(r);u<f.length;u++){var l=f[u];"_"!==l.slice(-1)&&(l in c&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),c[l]=r[l])}return c},e}(),D=/\{\$([^}]+)}/g,L=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=h(R(o[0])||""),n=h(R(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},W=function(e){var t,n,r=L(e).claims,i=Math.floor((new Date).getTime()/1e3);return"object"==typeof r&&(r.hasOwnProperty("nbf")?t=r.nbf:r.hasOwnProperty("iat")&&(t=r.iat),n=r.hasOwnProperty("exp")?r.exp:t+86400),i&&t&&n&&i>=t&&i<=n},B=function(e){var t=L(e).claims;return"object"==typeof t&&t.hasOwnProperty("iat")?t.iat:null},U=function(e){var t=L(e),n=t.claims;return!!n&&"object"==typeof n&&n.hasOwnProperty("iat")},F=function(e){var t=L(e).claims;return"object"==typeof t&&!0===t.admin},V=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},$=function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]},K=function(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])},G=function(e,t){return K(t,function(t,n){e[t]=n}),e},H=function(e){return G({},e)},z=function(e){return"object"==typeof e&&null!==e},q=function(e){for(var t in e)return!1;return!0},Y=function(e){var t=0;for(var n in e)t++;return t},J=function(e,t,n){var r={};for(var i in e)r[i]=t.call(n,e[i],i,e);return r},Z=function(e,t,n){for(var r in e)if(t.call(n,e[r],r,e))return r},X=function(e,t,n){var r=Z(e,t,n);return r&&e[r]},Q=function(e){for(var t in e)return t},ee=function(e){var t=[],n=0;for(var r in e)t[n++]=e[r];return t},te=function(e,t){for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&!t(n,e[n]))return!1;return!0},ne=function(e){var t=[];return K(e,function(e,n){Array.isArray(n)?n.forEach(function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.length?"&"+t.join("&"):""},re=function(e){var t={};return e.replace(/^\?/,"").split("&").forEach(function(e){if(e){var n=e.split("=");t[n[0]]=n[1]}}),t},ie=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"==typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(var r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(var r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,a,s=this.chain_[0],c=this.chain_[1],u=this.chain_[2],f=this.chain_[3],l=this.chain_[4],r=0;r<80;r++){r<40?r<20?(o=f^c&(u^f),a=1518500249):(o=c^u^f,a=1859775393):r<60?(o=c&u|f&(c|u),a=2400959708):(o=c^u^f,a=3395469782);var i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295;l=f,f=u,u=4294967295&(c<<30|c>>>2),c=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+f&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0==o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}(),oe=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(function(){e(n)}).catch(function(e){n.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=g(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=b),void 0===r.error&&(r.error=b),void 0===r.complete&&(r.complete=b);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}}),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){t.observers=void 0,t.onNoObservers=void 0}))},e}(),ae=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){var o=e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}},se=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,O(r<e.length,"Surrogate pair missing trail surrogate.");i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},ce=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};t.CONSTANTS=E,t.Deferred=x,t.ErrorFactory=j,t.FirebaseError=M,t.Sha1=ie,t.assert=O,t.assertionError=P,t.async=m,t.base64=N,t.base64Decode=R,t.base64Encode=C,t.clone=H,t.contains=V,t.createSubscribe=v,t.decode=L,t.deepCopy=r,t.deepExtend=i,t.errorPrefix=y,t.every=te,t.extend=G,t.findKey=Z,t.findValue=X,t.forEach=K,t.getAnyKey=Q,t.getCount=Y,t.getUA=a,t.getValues=ee,t.isAdmin=F,t.isBrowser=u,t.isEmpty=q,t.isMobileCordova=s,t.isNode=c,t.isNodeSdk=l,t.isNonNullObject=z,t.isReactNative=f,t.isValidFormat=U,t.isValidTimestamp=W,t.issuedAtTime=B,t.jsonEval=h,t.map=J,t.patchProperty=o,t.querystring=ne,t.querystringDecode=re,t.safeGet=$,t.stringLength=ce,t.stringToByteArray=se,t.stringify=p,t.validateArgCount=ae,t.validateCallback=_,t.validateContextObject=k,t.validateNamespace=w}).call(t,n(11))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return h});var a=n(0),s=(n.n(a),n(7)),c=n(29),u=n(3),f=n(12),l=["notifyButtonHovering","notifyButtonHover","notifyButtonButtonClick","notifyButtonLauncherClick","animatedElementHiding","animatedElementHidden","animatedElementShowing","animatedElementShown","activeAnimatedElementActivating","activeAnimatedElementActive","activeAnimatedElementInactivating","activeAnimatedElementInactive","dbRetrieved","dbSet","testEvent"],d=["mtsdk.prompt.custom.clicked","mtsdk.prompt.native.permissionchanged","mtsdk.subscription.changed","mtsdk.internal.subscriptionset","dbRebuilt","initialize","subscriptionSet","sendWelcomeNotification","subscriptionChange","notificationPermissionChange","dbSet","register","notificationDisplay","notificationDismiss","notificationClick","permissionPromptDisplay","testWouldDisplay","testInitOptionDisabled","popupWindowTimeout"],h=function(){function e(){r(this,e)}return o(e,null,[{key:"trigger",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!l.includes(e)){var r=t;if(n)var i="".concat(u.a.getWindowEnv().toString(),"  ").concat(n);else var i=u.a.getWindowEnv().toString();r||!1===r?a.debug("(".concat(i,")  %c").concat(e,":"),r):a.debug("(".concat(i,")  %c").concat(e))}if(c.a.isBrowser()&&$mtsdk.emit(e,t),c.a.isBrowser()&&u.a.getWindowEnv()===f.f){opener||parent?d.includes(e)&&u.a.getWindowEnv()===f.f&&$mtsdk.subscriptionPopup.message(s.a.POSTMAM_COMMANDS.REMOTE_RETRIGGER_EVENT,{eventName:e,eventData:t}):a.error("Could not send event '".concat(e,"' back to host page because no creator (opener or parent) found!"))}}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"b",function(){return c}),n.d(t,"a",function(){return f});var c={Stylesheet:"Stylesheet",Script:"Script"},u={Loaded:"Loaded",Failed:"Failed"},f=function(){function e(){o(this,e),this.cache={}}return s(e,[{key:"loadIfNew",value:function(){function t(e,t){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n,r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.cache[r.toString()]||(this.cache[r.toString()]=e.load(n,r)),t.next=3,this.cache[r.toString()];case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}},t,this)}));return t}()}],[{key:"load",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise(function(e,r){var i;switch(t){case c.Script:i=document.createElement("script"),i.setAttribute("type","text/javascript"),i.setAttribute("async","async"),i.setAttribute("src",n.toString());break;case c.Stylesheet:i=document.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",n.toString())}i.onerror=r,i.onload=e,document.querySelector("head").appendChild(i)});case 3:return e.abrupt("return",u.Loaded);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",u.Failed);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return e}()}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(35),i=(n.n(r),n(36)),o=(n.n(i),n(51)),a=(n.n(o),n(60)),s=n(91),c=n(92);if(!window.$mtsdk){window.$mtsdk=new c.a;var u=new a.a,f=new s.a(window.mtPush.q||[],u);window.mtPush=function(){f.handle(arguments)}}},function(e,t){!function(t){"use strict";function n(e,t,n,r){var o=t&&t.prototype instanceof i?t:i,a=Object.create(o.prototype),s=new h(r||[]);return a._invoke=u(e,n,s),a}function r(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function i(){}function o(){}function a(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function c(e){function t(n,i,o,a){var s=r(e[n],e,i);if("throw"!==s.type){var c=s.arg,u=c.value;return u&&"object"==typeof u&&b.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,o,a)},function(e){t("throw",e,o,a)}):Promise.resolve(u).then(function(e){c.value=e,o(c)},a)}a(s.arg)}function n(e,n){function r(){return new Promise(function(r,i){t(e,n,r,i)})}return i=i?i.then(r,r):r()}var i;this._invoke=n}function u(e,t,n){var i=O;return function(o,a){if(i===T)throw new Error("Generator is already running");if(i===I){if("throw"===o)throw a;return v()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var c=f(s,n);if(c){if(c===N)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===O)throw i=I,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=T;var u=r(e,t,n);if("normal"===u.type){if(i=n.done?I:P,u.arg===N)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=I,n.method="throw",n.arg=u.arg)}}}function f(e,t){var n=e.iterator[t.method];if(n===m){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=m,f(e,t),"throw"===t.method))return N;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return N}var i=r(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,N;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=m),t.delegate=null,N):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,N)}function l(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function d(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function h(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(l,this),this.reset(!0)}function p(e){if(e){var t=e[w];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(b.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=m,t.done=!0,t};return r.next=r}}return{next:v}}function v(){return{value:m,done:!0}}var m,g=Object.prototype,b=g.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},w=y.iterator||"@@iterator",_=y.asyncIterator||"@@asyncIterator",k=y.toStringTag||"@@toStringTag",S="object"==typeof e,E=t.regeneratorRuntime;if(E)return void(S&&(e.exports=E));E=t.regeneratorRuntime=S?e.exports:{},E.wrap=n;var O="suspendedStart",P="suspendedYield",T="executing",I="completed",N={},C={};C[w]=function(){return this};var R=Object.getPrototypeOf,x=R&&R(R(p([])));x&&x!==g&&b.call(x,w)&&(C=x);var A=a.prototype=i.prototype=Object.create(C);o.prototype=A.constructor=a,a.constructor=o,a[k]=o.displayName="GeneratorFunction",E.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===o||"GeneratorFunction"===(t.displayName||t.name))},E.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,a):(e.__proto__=a,k in e||(e[k]="GeneratorFunction")),e.prototype=Object.create(A),e},E.awrap=function(e){return{__await:e}},s(c.prototype),c.prototype[_]=function(){return this},E.AsyncIterator=c,E.async=function(e,t,r,i){var o=new c(n(e,t,r,i));return E.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},s(A),A[k]="Generator",A[w]=function(){return this},A.toString=function(){return"[object Generator]"},E.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},E.values=p,h.prototype={constructor:h,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(d),!e)for(var t in this)"t"===t.charAt(0)&&b.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,r){return o.type="throw",o.arg=e,n.next=t,r&&(n.method="next",n.arg=m),!!r}if(this.done)throw e;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return t("end");if(i.tryLoc<=this.prev){var a=b.call(i,"catchLoc"),s=b.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return t(i.catchLoc,!0);if(this.prev<i.finallyLoc)return t(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return t(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return t(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&b.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,N):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),N},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),d(n),N}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;d(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:p(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=m),N}}}(function(){return this}()||Function("return this")())},function(e,t,n){"use strict";var r=n(15),i=n(47),o=n(50),a=i(!0);r({target:"Array",proto:!0},{includes:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),o("includes")},function(e,t,n){var r=n(8),i=n(38),o=n(16),a=n(17),s=n(20),c=n(21),u=n(22),f=Object.getOwnPropertyDescriptor;t.f=r?f:function(e,t){if(e=a(e),t=s(t,!0),u)try{return f(e,t)}catch(e){}if(c(e,t))return o(!i.f.call(e,t),e[t])}},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,o=i&&!r.call({1:2},1);t.f=o?function(e){var t=i(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(5),i=n(18),o="".split;e.exports=r(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==i(e)?o.call(e,""):Object(e)}:Object},function(e,t,n){var r=n(4),i=n(9),o=r.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){var r=n(5),i=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==u||n!=c&&("function"==typeof t?r(t):!!t)},a=o.normalize=function(e){return String(e).replace(i,".").toLowerCase()},s=o.data={},c=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},function(e,t){e.exports={}},function(e,t,n){var r=n(44);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var r=n(8),i=n(22),o=n(46),a=n(20),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(9);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){var r=n(17),i=n(48),o=n(49);e.exports=function(e){return function(t,n,a){var s,c=r(t),u=i(c.length),f=o(a,u);if(e&&n!=n){for(;u>f;)if((s=c[f++])!=s)return!0}else for(;u>f;f++)if((e||f in c)&&c[f]===n)return e||f||0;return!e&&-1}}},function(e,t,n){var r=n(24),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t,n){var r=n(24),i=Math.max,o=Math.min;e.exports=function(e,t){var n=r(e);return n<0?i(n+t,0):o(n,t)}},function(e,t){e.exports=function(){}},function(e,t,n){"use strict";var r=n(15),i=n(52);r({target:"String",proto:!0,forced:!n(59)("includes")},{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(53),i=n(19);e.exports=function(e,t,n){if(r(t))throw TypeError("String.prototype."+n+" doesn't accept regex");return String(i(e))}},function(e,t,n){var r=n(9),i=n(18),o=n(25),a=o("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(4),i=n(55),o=n(56),a=r["__core-js_shared__"]||i("__core-js_shared__",{});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.1.3",mode:o?"pure":"global",copyright:" 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(4),i=n(23);e.exports=function(e,t){try{i(r,e,t)}catch(n){r[e]=t}return t}},function(e,t){e.exports=!0},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t,n){var r=n(5);e.exports=!!Object.getOwnPropertySymbols&&!r(function(){return!String(Symbol())})},function(e,t,n){var r=n(25),i=r("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[i]=!1,"/./"[e](t)}catch(e){}}return!1}},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return C});var c=n(2),u=n(6),f=n.n(u),l=n(0),d=(n.n(l),n(62)),h=n(27),p=n(65),v=n(72),m=n(33),g=n(13),b=n(74),y=n(3),w=n(14),_=n(77),k=n(79),S=n(83),E=n(7),O=n(84),P=n(88),T=n(1),I=n(89),N=n(90),C=function(){function e(){var t=this;o(this,e),this.config=c.a,this.visitor=new k.a,$mtsdk.welcomeNotification=null,this.visitorEvent=new S.a(500),this.traitValidator=new _.a,this.loaded=!1,this.visitorEvent.listen(k.a.EVENTS.UPDATED,d.a.collect),$mtsdk.once($mtsdk.EVENTS.SDK_INITIALIZED,i(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.visitor.ready;case 2:n=e.sent,n.synced||(l.debug("Visitor not synced, sync:",n),$mtsdk.emit(k.a.EVENTS.UPDATED,n));case 4:case"end":return e.stop()}},e)})))}return s(e,[{key:"set",value:function(){function e(e,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.visitor.ready;case 2:r=e.sent,"string"==typeof t&&"userId"===t&&(r.userId=n);case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"addTag",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("Add visitor tag",t),e.next=3,$mtsdk.loaded;case 3:return e.next=5,this.visitor.ready;case 5:n=e.sent,n.addTag(t);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"removeTag",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("Remove visitor tag",t),e.next=3,$mtsdk.loaded;case 3:return e.next=5,this.visitor.ready;case 5:n=e.sent,n.removeTag(t);case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"setTraits",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("Set visitor traits",t),e.next=3,$mtsdk.loaded;case 3:return e.next=5,this.visitor.ready;case 5:n=e.sent,this.traitValidator.validate(t),this.traitValidator.hasValidTraits()&&n.setTraits(this.traitValidator.getValid()),this.traitValidator.hasErrors()&&this.traitValidator.getErrors().forEach(function(e){l.warn("Failed to set traits:",e)});case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"setLanguage",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("Set visitor language",t),e.next=3,$mtsdk.loaded;case 3:return e.next=5,this.visitor.ready;case 5:n=e.sent,r=t.toLowerCase().trim(),Object(P.b)(r)?n.language=r:l.warn("Failed to set language: ".concat(r," from available ").concat(P.a.join(",")));case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"ready",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$mtsdk.loaded;case 2:t($mtsdk);case 3:case"end":return e.stop()}},e)}));return e}()},{key:"triggerPrompt",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.debug("Trigger manual prompt id: ",t),e.next=3,$mtsdk.loaded;case 3:return e.next=5,this.visitor.ready;case 5:if(n=$mtsdk.promptManager.getManualPrompt(t)){e.next=9;break}return l.debug("Core: Error no manual prompt with ID: ",t),e.abrupt("return");case 9:if(this.visitor.notificationPermission!==w.a){e.next=14;break}if(!$mtsdk.promptManager.nativePromptShown){e.next=13;break}return l.debug("Native prompt already shown. Prompt cant be shown: ",t),e.abrupt("return");case 13:$mtsdk.promptManager.show(t);case 14:case"end":return e.stop()}},e,this)}));return e}()},{key:"create",value:function(){function e(e,n,r,i,o){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,n,r,o,a){var s,c,u,d,p,y,_,k,S=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(T.f)()){e.next=3;break}return l.debug("Web push is not supported"),e.abrupt("return");case 3:if(f.a.safari||!o.data.config.data.https_enabled||Object(T.e)()){e.next=6;break}return l.debug("Web push is supported in https pages only"),e.abrupt("return");case 6:if(!f.a.safari||o.data.safari_web_id.length&&o.data.safari_website_url.length&&window.location.href.startsWith(o.data.safari_website_url)){e.next=9;break}return l.debug("Safari Web push is not supported"),e.abrupt("return");case 9:return e.next=11,this.visitor.ready;case 11:if(s=e.sent,c=!!this.loaded,this.loaded=!0,!c){e.next=17;break}return $mtsdk.trigger($mtsdk.EVENTS.SDK_INITIALIZED),e.abrupt("return");case 17:return $mtsdk.website=Object.assign(o.data.config.data,{id:o.data.id,syncId:t,push_branding:o.data.userConfig.data.push_branding,safariWebId:o.data.safari_web_id,safariWebsiteUrl:o.data.safari_website_url,automation:!!o.data.automation_on}),$mtsdk.visitor=s,void 0!==a&&(this.config=Object.assign(this.config,a)),this.syncId=t,this.domain=Object(T.c)(),this.config.push={css_url:n,push_branding:o.data.userConfig.data.push_branding},this.visitor.setDevice(r),this.visitor.setWebsiteId(o.data.id),e.next=27,$mtsdk.resourceLoader.loadIfNew(m.b.Stylesheet,this.config.push.css_url);case 27:return e.next=29,g.a.getNotificationPermission();case 29:if(u=e.sent,this.visitor.setNotificationPermission(u),$mtsdk._pushNotificationPermission=u,d=o.data.prompts||[],0!==d.length){e.next=36;break}return l.warn("Not active prompts for website"),e.abrupt("return");case 36:if(p=new N.a(f.a).filter(d),$mtsdk.promptManager=new b.a(p),o.data.welcomeNotification&&Object.keys(o.data.welcomeNotification).length>0&&o.data.welcomeNotification.creatives&&($mtsdk.welcomeNotification=new I.a(o.data.welcomeNotification.creatives)),o.data.traitMapping&&this.traitValidator.setMappings(o.data.traitMapping),$mtsdk.once($mtsdk.EVENTS.PROMPT.ALLOW,function(){var e=i(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.traits&&S.visitor.setTraits(n.traits);case 1:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}()),!f.a.safari){e.next=67;break}return l.debug("Safari app created"),this.visitor.setDevice(r),this.visitor.setWebsiteId(o.data.id),this.websiteId=o.data.id,e.next=48,g.a.getSafariNotificationPermission($mtsdk.website.safariWebId);case 48:if(y=e.sent,this.visitor.setNotificationPermission(y),$mtsdk._pushNotificationPermission=y,$mtsdk.welcomeNotification&&$mtsdk.once($mtsdk.EVENTS.SUBSCRIBE,function(){if($mtsdk.promptManager.hasShown()){var e=$mtsdk.welcomeNotification.getNotification(S.visitor.language);Object(T.l)(e.title,e.options)}}),_=function(){var e=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("granted"==t.permission&&t.deviceToken){e.next=4;break}return $mtsdk._pushNotificationPermission=t.permission,S.visitor.setNotificationPermission(t.permission),e.abrupt("return");case 4:if(S.visitor.notificationPermission==t.permission&&S.visitor.safariWebId==$mtsdk.website.safariWebId&&S.visitor.safariDeviceToken==t.deviceToken){e.next=10;break}return S.visitor.setSafariDeviceToken(t.deviceToken),S.visitor.setSafariWebId($mtsdk.website.safariWebId),e.next=9,S.visitor.persist();case 9:$mtsdk.trigger($mtsdk.EVENTS.SUBSCRIBE);case 10:$mtsdk._pushNotificationPermission=t.permission,S.visitor.setNotificationPermission(t.permission);case 12:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),$mtsdk.once($mtsdk.EVENTS.PROMPT.ALLOW,i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.subscribeSafariPromptPermission();case 2:if(t=e.sent,"granted"!==t.permission){e.next=6;break}return e.next=6,_(t);case 6:case"end":return e.stop()}},e)}))),"default"!==y){e.next=58;break}$mtsdk.promptManager.show(),e.next=64;break;case 58:if("granted"!==y){e.next=64;break}return e.next=61,g.a.getSafariNotificationData($mtsdk.website.safariWebId);case 61:return k=e.sent,e.next=64,_(k);case 64:$mtsdk.trigger($mtsdk.EVENTS.SDK_INITIALIZED),e.next=85;break;case 67:if(!o.data.config.data.https_enabled){e.next=84;break}if(l.debug("HTTPS app created"),"https:"===location.protocol){e.next=71;break}throw new h.a("Page is not secure");case 71:if(this.visitor.setDevice(r),this.visitor.setWebsiteId(o.data.id),"phone"===this.visitor.device&&(o.data.config.opt_in_type="auto"),this.websiteId=o.data.id,c){e.next=80;break}return $mtsdk.firebaseMessaging=Object(T.d)("mt-firebase-app"),$mtsdk.pushNotifications=new O.a(this,o.data.config.data),e.next=80,$mtsdk.pushNotifications.create();case 80:$mtsdk.trigger($mtsdk.EVENTS.SDK_INITIALIZED),$mtsdk.welcomeNotification&&$mtsdk.once($mtsdk.EVENTS.SUBSCRIBE,function(){if($mtsdk.promptManager.hasShown()){var e=$mtsdk.welcomeNotification.getNotification(S.visitor.language);Object(T.l)(e.title,e.options)}}),e.next=85;break;case 84:g.a.isUsingSubscriptionWorkaround()&&(l.debug("Loading web push workaround"),$mtsdk.trigger($mtsdk.EVENTS.SDK_INITIALIZED),$mtsdk.once($mtsdk.EVENTS.PROMPT.ALLOW,function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={httpPermissionRequest:!0},$mtsdk.subscriptionPopupHost=new v.a("https://".concat($mtsdk.website.http_domain,".").concat($mtsdk.config.proxy_frame_domain,"/subscribe/"),n),e.next=4,$mtsdk.subscriptionPopupHost.load();case 4:$mtsdk.subscriptionPopupHost.message(E.a.POSTMAM_COMMANDS.POPUP_LOAD_BODY,{popup:o.data.popup,website:$mtsdk.website,prompt:t});case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),this.visitor.notificationPermission===w.a&&$mtsdk.promptManager.show(),$mtsdk.once($mtsdk.EVENTS.SUBSCRIBE,function(){$mtsdk.welcomeNotification?($mtsdk.promptManager.hasShown()&&$mtsdk.subscriptionPopupHost.message(E.a.POSTMAM_COMMANDS.SHOW_WELCOME,$mtsdk.welcomeNotification.getNotification(S.visitor.language)),setTimeout(function(){$mtsdk.subscriptionPopupHost.message(E.a.POSTMAM_COMMANDS.CLOSE_POPUP,null)},1e3)):$mtsdk.subscriptionPopupHost.message(E.a.POSTMAM_COMMANDS.CLOSE_POPUP,null)}));case 85:case"end":return e.stop()}},e,this)}));return e}()},{key:"createHttp",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.a.getWindowEnv(),l.debug("Called createHttp (".concat(n,")")),$mtsdk.subscriptionPopup=new p.a(t),e.next=5,$mtsdk.subscriptionPopup.initialize();case 5:return e.next=7,g.a.getNotificationPermission();case 7:r=e.sent,this.__onPermissionChange(r),navigator.permissions&&navigator.permissions.query({name:"notifications"}).then(function(e){e.onchange=function(e){i.__onPermissionChange(e.target.state)}});case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"__onPermissionChange",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l.debug("Popup permission",t),$mtsdk.subscriptionPopup.message(E.a.POSTMAM_COMMANDS.REMOTE_NOTIFICATION_PERMISSION_CHANGED,{permission:t}),e.t0=t,e.next=e.t0===w.a?5:e.t0===w.c?10:e.t0===w.b?12:14;break;case 5:return e.next=7,Notification.requestPermission();case 7:return n=e.sent,l.debug("Request permission resulted in",n),e.abrupt("break",16);case 10:return $mtsdk.subscriptionPopup.subscribe(),e.abrupt("break",16);case 12:case 14:return window.close(),e.abrupt("break",16);case 16:case"end":return e.stop()}},e)}));return e}()}]),e}()},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return v});var h=n(26),p=n(0),v=(n.n(p),function(e){function t(){return o(this,t),c(this,f(t).apply(this,arguments))}return l(t,e),s(t,null,[{key:"collect",value:function(){function e(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function e(n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.synced=!1,r=[],n.tags.forEach(function(e){r.push(e)}),i=t.buildUrl({t:"visitor",uid:n.uid,uuid:n.userId,utag:encodeURIComponent(r.join(",")),utraits:encodeURIComponent(JSON.stringify(n.traits)),wid:n.websiteId,lang:n.language}),e.next=6,fetch(i);case 6:if(o=e.sent,200===o.status){e.next=10;break}return p.warn("Could not sync visitor with backend. Status Code: "+o.status),e.abrupt("return");case 10:p.debug("Visitor collected successfully",i),n.synced=!0;case 12:case"end":return e.stop()}},e)}));return e}()}]),t}(h.a))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?o(e):t}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var u=n(64),f=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occurred";return r(this,t),i(this,a(t).call(this,"MTSDK: "+e))}return s(t,e),t}(u.a);t.a=f},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return Object.defineProperty(n,"message",{configurable:!0,enumerable:!1,value:e,writable:!0}),Object.defineProperty(n,"name",{configurable:!0,enumerable:!1,value:n.constructor.name,writable:!0}),Error.hasOwnProperty("captureStackTrace")?(Error.captureStackTrace(n,n.constructor),i(n)):(Object.defineProperty(n,"stack",{configurable:!0,enumerable:!1,value:new Error(e).stack,writable:!0}),n)}return o(t,e),t}(function(e){function t(){e.apply(this,arguments)}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error));t.a=a},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return b});var h=n(7),p=n(3),v=n(67),m=n(0),g=(n.n(m),n(1)),b=function(e){function t(e){return o(this,t),c(this,f(t).call(this,e))}return l(t,e),s(t,[{key:"establishCrossOriginMessaging",value:function(){this.messenger=new h.a(window.opener,this.options.origin,this.options.origin),this.messenger.once(h.a.POSTMAM_COMMANDS.CONNECTED,this.onMessengerConnected.bind(this)),this.messenger.on(h.a.POSTMAM_COMMANDS.POPUP_LOAD_BODY,this.onLoadBody.bind(this)),this.messenger.on(h.a.POSTMAM_COMMANDS.SHOW_WELCOME,this.showWelcome.bind(this)),this.messenger.on(h.a.POSTMAM_COMMANDS.CLOSE_POPUP,this.closePopup.bind(this)),this.messenger.postMessage(h.a.POSTMAM_COMMANDS.POPUP_BEGIN_MESSAGEPORT_COMMS,null),this.messenger.postMessage(h.a.POSTMAM_COMMANDS.POPUP_LOADED,null),this.messenger.listen()}},{key:"onMessengerConnected",value:function(e){m.debug("(".concat(p.a.getWindowEnv().toString(),") The host page is now ready to receive commands from the HTTP popup.")),this.finishInitialization()}},{key:"onLoadBody",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n,r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m.debug("(".concat(p.a.getWindowEnv().toString(),") Load popup body"),t.data),n=t.data.website,r=t.data.prompt.body,i=t.data.popup.body,$mtsdk.website=n,o='\n        <div class="mt-dialog">\n            <div class="mt-card">\n                <div class="mt-card-media"><img src="'.concat(r.icon.src,'"></div>\n                <div class="mt-card-text">\n\t\t\t\t\t').concat(i.text,"\n                </div>\n                ").concat(n.push_branding?'<div class="mt-card-branding"><a target="_blank" href="https://maxtraffic.com">Powered By <span class="mt-logo"><svg id="Layer_1" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" xml:space="preserve" viewBox="0 0 429.32796 77.524862" width="90" version="1.1" y="0px" x="0px" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/"><path id="path3662" fill="#ff7c14" d="m117 76.025h-15.7l1.4-5.6c-3.6 3.1-8.2 7.1-14.5 7.1-1.1 0-10.7 0-10.7-9.8 0-3.3 2.1-12.8 5.4-16.6s8.2-5.2 27-10.7c0.5-2.1 1.2-5.5 1.2-6.4 0-2.8-2.6-3-4.3-3-4.5 0-5.3 2.4-6.9 7.9h-15.2c2.3-9.4 3.5-12.5 8.5-15 3.7-1.9 8.9-2.8 14.5-2.8 9.3 0 18.9 2.3 18.9 11.8 0 2-0.4 4-0.9 6-0.1-0.1-8.3 35.8-8.7 37.1zm-9.3-25.3c-3.6 1.1-8.3 2.5-10.2 4-2.6 2.1-3.3 7.9-3.3 8.9 0 1.8 0.8 3.3 3.5 3.3 2.8 0 4.9-1.7 6.7-3.2l3.3-13z" class="st0"></path><path id="path3664" fill="#ff7c14" d="m134.7 21.925h15.9l3 14.7 8.5-14.7h16.7l-18.2 27.1 7.3 26.9h-15.7l-3.4-15.7-9.4 15.7h-17.7l20.3-28.8-7.3-25.2z" class="st0"></path><path id="path3666" fill="#ff7c14" d="m178.2 4.8249h42.2l-2.8 12.3h-11.9l-13.6 58.9h-17.4l13.6-58.9h-13l2.9-12.3z" class="st0"></path><path id="path3668" fill="#ff7c14" d="m230.8 32.725c4.4-8.5 7.8-10.4 16.2-11.7l-4 15c-1.1-0.1-2.2-0.1-3.3-0.1-8.9 0-10.5 3.8-12.8 13.7l-6 26.3h-15.9l12.5-54h15.9l-2.6 10.8z" class="st0"></path><path id="path3670" fill="#ff7c14" d="m279.1 69.825c-0.1 0.8-0.3 1.6-0.3 2.4 0 2.4 0.7 2.9 1.5 3.7h-18.4l1.4-5.6c-3.6 3.1-8.2 7.1-14.5 7.1-1.1 0-10.7 0-10.7-9.8 0-3.3 2.1-12.8 5.4-16.6s8.2-5.2 27-10.7c0.5-2.1 1.2-5.5 1.2-6.4 0-2.8-2.6-3-4.3-3-4.5 0-5.3 2.4-6.9 7.9h-15.3c2.3-9.4 3.5-12.5 8.5-15 3.7-1.9 8.9-2.8 14.5-2.8 9.3 0 18.9 2.3 18.9 11.8 0 2-0.4 4-0.9 6l-7.1 31zm-10.7-19.1c-3.6 1.1-8.3 2.5-10.2 4-2.6 2.1-3.3 7.9-3.3 8.9 0 1.8 0.8 3.3 3.5 3.3 2.8 0 4.9-1.7 6.7-3.2l3.3-13z" class="st0"></path><path id="path3672" fill="#ff7c14" d="m302.3 16.725c2-8.2 3.1-12.3 16.9-12.3 3 0 6 0.1 9.5 0.3l-2.3 9.9c-5.6-0.1-6.9 0.1-7.8 2.1-0.4 0.9-1.1 3.9-1.4 5.2h7.1l-2.3 9.7h-7.1l-10.2 44.4h-16.1l10.2-44.4h-6.5l2.2-9.7h6.6l1.2-5.2z" class="st0"></path><path id="path3674" fill="#ff7c14" d="m334.1 16.725c2-8.2 3.1-12.3 16.9-12.3 3 0 6 0.1 9.5 0.3l-2.3 9.9c-5.6-0.1-6.9 0.1-7.8 2.1-0.4 0.9-1.1 3.9-1.4 5.2h7.1l-2.3 9.7h-7.1l-10.2 44.4h-16.1l10.2-44.4h-15.2l2.2-9.7h15.3l1.2-5.2z" class="st0"></path><path id="path3676" fill="#ff7c14" d="m360.4 21.925h16l-12.5 54h-15.9l12.4-54zm20-17.1-2.8 12.1h-16l2.8-12.1h16z" class="st0"></path><path id="path3678" fill="#ff7c14" d="m401.1 31.325c-4.4 0-5.7 3.6-6.6 7.4l-5 21.6c-0.1 0.6-0.2 1.2-0.2 1.9 0 1.5 0.4 2.2 0.6 2.4 0.7 1.1 2.1 1.8 3.7 1.8 4.5 0 5.3-3.6 6.6-9.2h16.2c-1 4.6-2.1 9.4-5.1 13.3-4.1 5.2-11.1 6.9-17.8 6.9-4.6 0-19.7-1-19.7-14.4 0-7.1 5.9-28.4 6.2-28.9 4.1-12.4 14.4-13.3 21.9-13.3" class="st0"></path><g id="g3680" transform="translate(-75.3 -78.075)"><path id="path3682" fill="#ff7c14" d="m484.9 87.8c1.1 0.1 2.2-0.7 2.4-1.8l1.3-7c0.2-1.1 0.9-1.2 1.6-0.4l14 18.7c0.7 0.9 0.5 2.2-0.3 2.9l-22.9 20c-0.8 0.7-1.3 0.4-1.1-0.6l1.5-7.2c0.2-1.1-0.5-2.2-1.5-2.4 0 0-23.7-5.6-26.7 10.8 6.3-35.5 31.7-33 31.7-33z" class="st0"></path></g><path id="path3684" opacity=".75" d="m72.8 4.8249-32 71.2h-3.9l1.2-21c1.4-3.3 3.1-7.5 5-11.9 1.5-3.6 3.6-8.7 4.6-11l12.1-27.3" fill="#ff7c14" class="st1"></path><path id="path3686" fill="#ff7c14" d="m83.7 4.8249-16.4 71.2h-16l13.6-53.4 4.5-17.7" class="st0"></path><path id="path3688" opacity=".25" d="m30.8 4.8249-14.8 71.2h-16l16.4-71.2" fill="#ff7c14" class="st2"></path><path id="path3690" opacity=".5" d="m26.4 76.025 0.6-52.5 3.9-18.6h9.2l-0.7 20.1c0 1.7-0.3 10.6-0.3 12.6-0.3 6-1.8 31.9-2.2 38.5" fill="#ff7c14" class="st3"></path><line id="line3692" y2="75.825" x2="38.5" y1="54.825" x1="39.6" fill="#ff7c14" class="st0"></line></svg></span></a></div>':"","\n            </div>\n        </div>"),Object(g.b)("body","beforeend",'<div id="mt-content" class="mt-content">'+o+"</div>");case 5:case"end":return e.stop()}},e)}));return e}()},{key:"message",value:function(){var e;(e=this.messenger).message.apply(e,arguments)}},{key:"closePopup",value:function(){window.close()}},{key:"showWelcome",value:function(e){navigator.serviceWorker.getRegistration().then(function(t){return t.showNotification(e.data.title,e.data.options)}).catch(function(e){return console.warn("ERORR",e)})}}]),t}(v.a)},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return a});var a=function(){function e(){r(this,e)}return o(e,null,[{key:"generate",value:function(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e.generate)}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return l});var c=n(13),u=n(0),f=(n.n(u),n(2)),l=function(){function e(t){o(this,e),this.options={origin:t.origin}}return s(e,[{key:"initialize",value:function(){var e=this;return(window.opener||window.parent)===window?void u.error("This page cannot be directly opened, and must be opened as a result of a subscription call."):(this.loadPromise={},this.loadPromise.promise=new Promise(function(t,n){e.loadPromise.resolver=t,e.loadPromise.rejector=n}),this.establishCrossOriginMessaging(),this.loadPromise.promise)}},{key:"establishCrossOriginMessaging",value:function(){}},{key:"dispose",value:function(){this.messenger.destroy()}},{key:"finishInitialization",value:function(){this.loadPromise.resolver()}},{key:"subscribe",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.serviceWorker.register(f.a.worker,f.a.worker_options);case 3:t=e.sent,c.a.enableNotifications(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),u.error("Failed to register service worker in the popup/modal:",e.t0);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return e}()}]),e}()},function(e,t,n){"use strict";var r=function(e){return e&&"object"==typeof e&&"default"in e?e.default:e}(n(30));e.exports=r},function(e,t,n){"use strict";function r(e){o.forEach(function(t){t.logLevel=e})}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"LogLevel",function(){return i}),n.d(t,"Logger",function(){return c}),n.d(t,"setLogLevel",function(){return r});var i,o=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));var a=i.INFO,s=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(t<e.logLevel)){var o=(new Date).toISOString();switch(t){case i.DEBUG:case i.VERBOSE:console.log.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;case i.INFO:console.info.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;case i.WARN:console.warn.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;case i.ERROR:console.error.apply(console,["["+o+"]  "+e.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+t+")")}}},c=function(){function e(e){this.name=e,this._logLevel=a,this._logHandler=s,o.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.DEBUG].concat(e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.VERBOSE].concat(e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.INFO].concat(e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.WARN].concat(e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._logHandler.apply(this,[this,i.ERROR].concat(e))},e}()},function(e,t,n){"use strict";n(71)},function(e,t,n){"use strict";function r(e,t){if(null==e||null==t)return!1;if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<e.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function i(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,Object(k.__spread)(t)))}function o(e){return i(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(e){for(var t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}function s(e){if(e.objectStoreNames.contains(R)){var t=e.transaction(R),n=t.objectStore(R),r=new N,i=n.openCursor();i.onerror=function(e){console.warn("Unable to cleanup old IDB.",e)},i.onsuccess=function(){var t=i.result;if(t){var n=t.value;r.deleteToken(n.fcmSenderId,n.fcmToken,n.fcmPushSet),t.continue()}else e.close(),indexedDB.deleteDatabase(C)}}}function c(){var e=indexedDB.open(C);e.onerror=function(e){},e.onsuccess=function(t){s(e.result)}}function u(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){if(e.fcmToken&&("string"!=typeof e.fcmToken||0===e.fcmToken.length))throw O.create("bad-token");if(e.swScope&&("string"!=typeof e.swScope||0===e.swScope.length))throw O.create("bad-scope");if(e.vapidKey&&(!(e.vapidKey instanceof Uint8Array)||65!==e.vapidKey.length))throw O.create("bad-vapid-key");if(e.endpoint&&("string"!=typeof e.endpoint||0===e.endpoint.length))throw O.create("bad-subscription");if(e.auth&&!(e.auth instanceof ArrayBuffer))throw O.create("bad-subscription");if(e.p256dh&&!(e.p256dh instanceof ArrayBuffer))throw O.create("bad-subscription");if(e.fcmSenderId&&("string"!=typeof e.fcmSenderId||0===e.fcmSenderId.length))throw O.create("bad-sender-id");if(e.fcmPushSet&&("string"!=typeof e.fcmPushSet||0===e.fcmPushSet.length))throw O.create("bad-push-set")}function l(e,t,n){if(!n.vapidKey||!r(t.buffer,n.vapidKey.buffer))return!1;var i=e.endpoint===n.endpoint,o=r(e.getKey("auth"),n.auth),a=r(e.getKey("p256dh"),n.p256dh);return i&&o&&a}function d(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function h(e,t){var n;return n={},n[y.TYPE_OF_MSG]=e,n[y.DATA]=t,n}function p(){return Object(k.__awaiter)(this,void 0,void 0,function(){var e,t,n,r;return Object(k.__generator)(this,function(i){switch(i.label){case 0:if(!(e=document.querySelector('link[rel="manifest"]')))return[2];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(e.href)];case 2:return n=i.sent(),[4,n.json()];case 3:return t=i.sent(),[3,5];case 4:return r=i.sent(),[2];case 5:if(!t||!t.gcm_sender_id)return[2];if("103953800507"!==t.gcm_sender_id)throw O.create("incorrect-gcm-sender-id");return[2]}})})}function v(){return self&&"ServiceWorkerGlobalScope"in self?g():m()}function m(){return navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function g(){return"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}var b,y,w=n(30),_=n.n(w),k=n(10),S=n(31),E=(n.n(S),b={},b["only-available-in-window"]="This method is available in a Window context.",b["only-available-in-sw"]="This method is available in a service worker context.",b["should-be-overriden"]="This method should be overriden by extended classes.",b["bad-sender-id"]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",b["permission-default"]="The required permissions were not granted and dismissed instead.",b["permission-blocked"]="The required permissions were not granted and blocked instead.",b["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",b["notifications-blocked"]="Notifications have been blocked.",b["failed-serviceworker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",b["sw-registration-expected"]="A service worker registration was the expected input.",b["get-subscription-failed"]="There was an error when trying to get any existing Push Subscriptions.",b["invalid-saved-token"]="Unable to access details of the saved token.",b["sw-reg-redundant"]="The service worker being used for push was made redundant.",b["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",b["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",b["token-subscribe-no-push-set"]="FCM returned an invalid response when getting an FCM token.",b["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",b["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",b["token-update-no-token"]="FCM returned no token when updating the user to push.",b["use-sw-before-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",b["invalid-delete-token"]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",b["delete-token-not-found"]="The deletion attempt for token could not be performed as the token was not found.",b["delete-scope-not-found"]="The deletion attempt for service worker scope could not be performed as the scope was not found.",b["bg-handler-function-expected"]="The input to setBackgroundMessageHandler() must be a function.",b["no-window-client-to-msg"]="An attempt was made to message a non-existant window client.",b["unable-to-resubscribe"]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$errorInfo}",b["no-fcm-token-for-resubscribe"]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",b["failed-to-delete-token"]="Unable to delete the currently saved token.",b["no-sw-in-reg"]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",b["incorrect-gcm-sender-id"]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",b["bad-scope"]="The service worker scope must be a string with at least one character.",b["bad-vapid-key"]="The public VAPID key is not a Uint8Array with 65 bytes.",b["bad-subscription"]="The subscription must be a valid PushSubscription.",b["bad-token"]="The FCM Token used for storage / lookup was not a valid token string.",b["bad-push-set"]="The FCM push set used for storage / lookup was not not a valid push set string.",b["failed-delete-vapid-key"]="The VAPID key could not be deleted.",b["invalid-public-vapid-key"]="The public VAPID key must be a string.",b["use-public-key-before-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",b["public-vapid-key-decryption-failed"]="The public VAPID key did not equal 65 bytes when decrypted.",b),O=new S.ErrorFactory("messaging","Messaging",E),P=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),T="https://fcm.googleapis.com";!function(e){e.TYPE_OF_MSG="firebase-messaging-msg-type",e.DATA="firebase-messaging-msg-data"}(y||(y={}));var I;!function(e){e.PUSH_MSG_RECEIVED="push-msg-received",e.NOTIFICATION_CLICKED="notification-clicked"}(I||(I={}));var N=function(){function e(){}return e.prototype.getToken=function(e,t,n){return Object(k.__awaiter)(this,void 0,void 0,function(){var i,a,s,c,u,f,l,d,h,p;return Object(k.__generator)(this,function(v){switch(v.label){case 0:i=o(t.getKey("p256dh")),a=o(t.getKey("auth")),s="authorized_entity="+e+"&endpoint="+t.endpoint+"&encryption_key="+i+"&encryption_auth="+a,r(n.buffer,P.buffer)||(c=o(n),s+="&application_pub_key="+c),u=new Headers,u.append("Content-Type","application/x-www-form-urlencoded"),f={method:"POST",headers:u,body:s},v.label=1;case 1:return v.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/subscribe",f)];case 2:return d=v.sent(),[4,d.json()];case 3:return l=v.sent(),[3,5];case 4:throw h=v.sent(),O.create("token-subscribe-failed",{errorInfo:h});case 5:if(l.error)throw p=l.error.message,O.create("token-subscribe-failed",{errorInfo:p});if(!l.token)throw O.create("token-subscribe-no-token");if(!l.pushSet)throw O.create("token-subscribe-no-push-set");return[2,{token:l.token,pushSet:l.pushSet}]}})})},e.prototype.updateToken=function(e,t,n,i,a){return Object(k.__awaiter)(this,void 0,void 0,function(){var s,c,u,f,l,d,h,p,v,m;return Object(k.__generator)(this,function(g){switch(g.label){case 0:s=o(i.getKey("p256dh")),c=o(i.getKey("auth")),u="push_set="+n+"&token="+t+"&authorized_entity="+e+"&endpoint="+i.endpoint+"&encryption_key="+s+"&encryption_auth="+c,r(a.buffer,P.buffer)||(f=o(a),u+="&application_pub_key="+f),l=new Headers,l.append("Content-Type","application/x-www-form-urlencoded"),d={method:"POST",headers:l,body:u},g.label=1;case 1:return g.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/subscribe",d)];case 2:return p=g.sent(),[4,p.json()];case 3:return h=g.sent(),[3,5];case 4:throw v=g.sent(),O.create("token-update-failed",{errorInfo:v});case 5:if(h.error)throw m=h.error.message,O.create("token-update-failed",{errorInfo:m});if(!h.token)throw O.create("token-update-no-token");return[2,h.token]}})})},e.prototype.deleteToken=function(e,t,n){return Object(k.__awaiter)(this,void 0,void 0,function(){var r,i,o,a,s,c,u;return Object(k.__generator)(this,function(f){switch(f.label){case 0:r="authorized_entity="+e+"&token="+t+"&pushSet="+n,i=new Headers,i.append("Content-Type","application/x-www-form-urlencoded"),o={method:"POST",headers:i,body:r},f.label=1;case 1:return f.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/unsubscribe",o)];case 2:return a=f.sent(),[4,a.json()];case 3:if(s=f.sent(),s.error)throw c=s.error.message,O.create("token-unsubscribe-failed",{errorInfo:c});return[3,5];case 4:throw u=f.sent(),O.create("token-unsubscribe-failed",{errorInfo:u});case 5:return[2]}})})},e}(),C="undefined",R="fcm_token_object_Store",x=function(){function e(){this.dbPromise=null}return e.prototype.get=function(e){return this.createTransaction(function(t){return t.get(e)})},e.prototype.getIndex=function(e,t){function n(n){return n.index(e).get(t)}return this.createTransaction(n)},e.prototype.put=function(e){return this.createTransaction(function(t){return t.put(e)},"readwrite")},e.prototype.delete=function(e){return this.createTransaction(function(t){return t.delete(e)},"readwrite")},e.prototype.closeDatabase=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){var e;return Object(k.__generator)(this,function(t){switch(t.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:e=t.sent(),e.close(),this.dbPromise=null,t.label=2;case 2:return[2]}})})},e.prototype.createTransaction=function(e,t){return void 0===t&&(t="readonly"),Object(k.__awaiter)(this,void 0,void 0,function(){var n,r,i,o;return Object(k.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,t),i=r.objectStore(this.objectStoreName),[4,u(e(i))];case 2:return o=a.sent(),[2,new Promise(function(e,t){r.oncomplete=function(){e(o)},r.onerror=function(){t(r.error)}})]}})})},e.prototype.getDb=function(){var e=this;return this.dbPromise||(this.dbPromise=new Promise(function(t,n){var r=indexedDB.open(e.dbName,e.dbVersion);r.onsuccess=function(){t(r.result)},r.onerror=function(){e.dbPromise=null,n(r.error)},r.onupgradeneeded=function(t){return e.onDbUpgrade(r,t)}})),this.dbPromise},e}(),A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_token_details_db",t.dbVersion=3,t.objectStoreName="fcm_token_object_Store",t}return Object(k.__extends)(t,e),t.prototype.onDbUpgrade=function(e,t){var n=e.result;switch(t.oldVersion){case 0:var r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"});r.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:c();case 2:var r=e.transaction.objectStore(this.objectStoreName),i=r.openCursor();i.onsuccess=function(){var e=i.result;if(e){var t=e.value,n=Object(k.__assign)({},t);t.createTime||(n.createTime=Date.now()),"string"==typeof t.vapidKey&&(n.vapidKey=a(t.vapidKey)),"string"==typeof t.auth&&(n.auth=a(t.auth).buffer),"string"==typeof t.auth&&(n.p256dh=a(t.p256dh).buffer),e.update(n),e.continue()}}}},t.prototype.getTokenDetailsFromToken=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(t){if(!e)throw O.create("bad-token");return f({fcmToken:e}),[2,this.getIndex("fcmToken",e)]})})},t.prototype.getTokenDetailsFromSWScope=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(t){if(!e)throw O.create("bad-scope");return f({swScope:e}),[2,this.get(e)]})})},t.prototype.saveTokenDetails=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(t){if(!e.swScope)throw O.create("bad-scope");if(!e.vapidKey)throw O.create("bad-vapid-key");if(!e.endpoint||!e.auth||!e.p256dh)throw O.create("bad-subscription");if(!e.fcmSenderId)throw O.create("bad-sender-id");if(!e.fcmToken)throw O.create("bad-token");if(!e.fcmPushSet)throw O.create("bad-push-set");return f(e),[2,this.put(e)]})})},t.prototype.deleteToken=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t;return Object(k.__generator)(this,function(n){switch(n.label){case 0:return"string"!=typeof e||0===e.length?[2,Promise.reject(O.create("invalid-delete-token"))]:[4,this.getTokenDetailsFromToken(e)];case 1:if(!(t=n.sent()))throw O.create("delete-token-not-found");return[4,this.delete(t.swScope)];case 2:return n.sent(),[2,t]}})})},t}(x),M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dbName="fcm_vapid_details_db",t.dbVersion=1,t.objectStoreName="fcm_vapid_object_Store",t}return Object(k.__extends)(t,e),t.prototype.onDbUpgrade=function(e){e.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},t.prototype.getVapidFromSWScope=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t;return Object(k.__generator)(this,function(n){switch(n.label){case 0:if("string"!=typeof e||0===e.length)throw O.create("bad-scope");return[4,this.get(e)];case 1:return t=n.sent(),[2,t?t.vapidKey:void 0]}})})},t.prototype.saveVapidDetails=function(e,t){return Object(k.__awaiter)(this,void 0,void 0,function(){var n;return Object(k.__generator)(this,function(r){if("string"!=typeof e||0===e.length)throw O.create("bad-scope");if(null===t||65!==t.length)throw O.create("bad-vapid-key");return n={swScope:e,vapidKey:t},[2,this.put(n)]})})},t.prototype.deleteVapidDetails=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t;return Object(k.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(e)];case 1:if(!(t=n.sent()))throw O.create("delete-scope-not-found");return[4,this.delete(e)];case 2:return n.sent(),[2,t]}})})},t}(x),j="messagingSenderId",D=function(){function e(e){var t=this;if(!e.options[j]||"string"!=typeof e.options[j])throw O.create("bad-sender-id");this.messagingSenderId=e.options[j],this.tokenDetailsModel=new A,this.vapidDetailsModel=new M,this.iidModel=new N,this.app=e,this.INTERNAL={delete:function(){return t.delete()}}}return e.prototype.getToken=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i;return Object(k.__generator)(this,function(o){switch(o.label){case 0:if("denied"===(e=this.getNotificationPermission_()))throw O.create("notifications-blocked");return"granted"!==e?[2,null]:[4,this.getSWRegistration_()];case 1:return t=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(t,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(t.scope)];case 4:return i=o.sent(),i?[2,this.manageExistingToken(t,r,n,i)]:[2,this.getNewToken(t,r,n)]}})})},e.prototype.manageExistingToken=function(e,t,n,r){return Object(k.__awaiter)(this,void 0,void 0,function(){var i,o;return Object(k.__generator)(this,function(a){switch(a.label){case 0:return i=l(t,n,r),i?(o=Date.now(),o<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(e,t,n,r)]):[4,this.deleteTokenFromDB(r.fcmToken)];case 1:return a.sent(),[2,this.getNewToken(e,t,n)]}})})},e.prototype.updateToken=function(e,t,n,r){return Object(k.__awaiter)(this,void 0,void 0,function(){var i,o,a;return Object(k.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,r.fcmToken,r.fcmPushSet,t,n)];case 1:return i=s.sent(),o={swScope:e.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:i,fcmPushSet:r.fcmPushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}})})},e.prototype.getNewToken=function(e,t,n){return Object(k.__awaiter)(this,void 0,void 0,function(){var r,i;return Object(k.__generator)(this,function(o){switch(o.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,t,n)];case 1:return r=o.sent(),i={swScope:e.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:r.token,fcmPushSet:r.pushSet,createTime:Date.now(),endpoint:t.endpoint,auth:t.getKey("auth"),p256dh:t.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(e.scope,n)];case 3:return o.sent(),[2,r.token]}})})},e.prototype.deleteToken=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(k.__generator)(this,function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(e)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return t=r.sent(),t?[4,t.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}})})},e.prototype.deleteTokenFromDB=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t;return Object(k.__generator)(this,function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(e)];case 1:return t=n.sent(),[4,this.iidModel.deleteToken(t.fcmSenderId,t.fcmToken,t.fcmPushSet)];case 2:return n.sent(),[2]}})})},e.prototype.getPushSubscription=function(e,t){return e.pushManager.getSubscription().then(function(n){return n||e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t})})},e.prototype.requestPermission=function(){throw O.create("only-available-in-window")},e.prototype.useServiceWorker=function(e){throw O.create("only-available-in-window")},e.prototype.usePublicVapidKey=function(e){throw O.create("only-available-in-window")},e.prototype.onMessage=function(e,t,n){throw O.create("only-available-in-window")},e.prototype.onTokenRefresh=function(e,t,n){throw O.create("only-available-in-window")},e.prototype.setBackgroundMessageHandler=function(e){throw O.create("only-available-in-sw")},e.prototype.delete=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return e.sent(),[2]}})})},e.prototype.getNotificationPermission_=function(){return Notification.permission},e.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},e.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},e.prototype.getIidModel=function(){return this.iidModel},e}(),L=function(e){function t(t){var n=e.call(this,t)||this;return n.bgMessageHandler=null,self.addEventListener("push",function(e){n.onPush(e)}),self.addEventListener("pushsubscriptionchange",function(e){n.onSubChange(e)}),self.addEventListener("notificationclick",function(e){n.onNotificationClick(e)}),n}return Object(k.__extends)(t,e),t.prototype.onPush=function(e){e.waitUntil(this.onPush_(e))},t.prototype.onSubChange=function(e){e.waitUntil(this.onSubChange_(e))},t.prototype.onNotificationClick=function(e){e.waitUntil(this.onNotificationClick_(e))},t.prototype.onPush_=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,o,a,s;return Object(k.__generator)(this,function(c){switch(c.label){case 0:if(!e.data)return[2];try{t=e.data.json()}catch(e){return[2]}return[4,this.hasVisibleClients_()];case 1:return(n=c.sent())?[2,this.sendMessageToWindowClients_(t)]:(r=this.getNotificationData_(t))?(i=r.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return o=c.sent(),a=r.actions,s=Notification.maxActions,a&&s&&a.length>s&&console.warn("This browser only supports "+s+" actions.The remaining actions will not be displayed."),[2,o.showNotification(i,r)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(t)]:[3,5];case 4:return c.sent(),[2];case 5:return[2]}})})},t.prototype.onSubChange_=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var e,t,n,r,i;return Object(k.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return e=o.sent(),[3,3];case 2:throw t=o.sent(),O.create("unable-to-resubscribe",{errorInfo:t});case 3:return o.trys.push([3,5,,8]),[4,e.pushManager.getSubscription()];case 4:return o.sent(),[3,8];case 5:return n=o.sent(),r=this.getTokenDetailsModel(),[4,r.getTokenDetailsFromSWScope(e.scope)];case 6:if(!(i=o.sent()))throw n;return[4,this.deleteToken(i.fcmToken)];case 7:throw o.sent(),n;case 8:return[2]}})})},t.prototype.onNotificationClick_=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t,n,r,i;return Object(k.__generator)(this,function(o){switch(o.label){case 0:return e.notification&&e.notification.data&&e.notification.data.FCM_MSG?e.action?[2]:(e.stopImmediatePropagation(),e.notification.close(),t=e.notification.data.FCM_MSG,t.notification?(n=t.fcmOptions&&t.fcmOptions.link||t.notification.click_action,n?[4,this.getWindowClient_(n)]:[2]):[2]):[2];case 1:return r=o.sent(),r?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=o.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=o.sent(),o.label=5;case 5:return r?(delete t.notification,delete t.fcmOptions,i=h(I.NOTIFICATION_CLICKED,t),[2,this.attemptToMessageClient_(r,i)]):[2]}})})},t.prototype.getNotificationData_=function(e){var t;if(e&&"object"==typeof e.notification){var n=Object(k.__assign)({},e.notification);return n.data=Object(k.__assign)({},e.notification.data,(t={},t.FCM_MSG=e,t)),n}},t.prototype.setBackgroundMessageHandler=function(e){if(!e||"function"!=typeof e)throw O.create("bg-handler-function-expected");this.bgMessageHandler=e},t.prototype.getWindowClient_=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,o;return Object(k.__generator)(this,function(a){switch(a.label){case 0:return t=new URL(e,self.location.href).href,[4,d()];case 1:for(n=a.sent(),r=null,i=0;i<n.length;i++)if((o=new URL(n[i].url,self.location.href).href)===t){r=n[i];break}return[2,r]}})})},t.prototype.attemptToMessageClient_=function(e,t){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(n){if(!e)throw O.create("no-window-client-to-msg");return e.postMessage(t),[2]})})},t.prototype.hasVisibleClients_=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){var e;return Object(k.__generator)(this,function(t){switch(t.label){case 0:return[4,d()];case 1:return e=t.sent(),[2,e.some(function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")})]}})})},t.prototype.sendMessageToWindowClients_=function(e){return Object(k.__awaiter)(this,void 0,void 0,function(){var t,n,r=this;return Object(k.__generator)(this,function(i){switch(i.label){case 0:return[4,d()];case 1:return t=i.sent(),n=h(I.PUSH_MSG_RECEIVED,e),[4,Promise.all(t.map(function(e){return r.attemptToMessageClient_(e,n)}))];case 2:return i.sent(),[2]}})})},t.prototype.getSWRegistration_=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(e){return[2,self.registration]})})},t.prototype.getPublicVapidKey_=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(k.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(e=n.sent()))throw O.create("sw-registration-expected");return[4,this.getVapidDetailsModel().getVapidFromSWScope(e.scope)];case 2:return t=n.sent(),null==t?[2,P]:[2,t]}})})},t}(D),W=function(e){function t(t){var n=e.call(this,t)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.manifestCheckPromise=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=Object(S.createSubscribe)(function(e){n.messageObserver=e}),n.onTokenRefreshInternal=Object(S.createSubscribe)(function(e){n.tokenRefreshObserver=e}),n.setupSWMessageListener_(),n}return Object(k.__extends)(t,e),t.prototype.getToken=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(t){switch(t.label){case 0:return this.manifestCheckPromise||(this.manifestCheckPromise=p()),[4,this.manifestCheckPromise];case 1:return t.sent(),[2,e.prototype.getToken.call(this)]}})})},t.prototype.requestPermission=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){var e;return Object(k.__generator)(this,function(t){switch(t.label){case 0:return"granted"===this.getNotificationPermission_()?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(e=t.sent()))return[2];throw"denied"===e?O.create("permission-blocked"):O.create("permission-default")}})})},t.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw O.create("sw-registration-expected");if(null!=this.registrationToUse)throw O.create("use-sw-before-get-token");this.registrationToUse=e},t.prototype.usePublicVapidKey=function(e){if("string"!=typeof e)throw O.create("invalid-public-vapid-key");if(null!=this.publicVapidKeyToUse)throw O.create("use-public-key-before-get-token");var t=a(e);if(65!==t.length)throw O.create("public-vapid-key-decryption-failed");this.publicVapidKeyToUse=t},t.prototype.onMessage=function(e,t,n){return"function"==typeof e?this.onMessageInternal(e,t,n):this.onMessageInternal(e)},t.prototype.onTokenRefresh=function(e,t,n){return"function"==typeof e?this.onTokenRefreshInternal(e,t,n):this.onTokenRefreshInternal(e)},t.prototype.waitForRegistrationToActivate_=function(e){var t=e.installing||e.waiting||e.active;return new Promise(function(n,r){if(!t)return void r(O.create("no-sw-in-reg"));if("activated"===t.state)return void n(e);if("redundant"===t.state)return void r(O.create("sw-reg-redundant"));var i=function(){if("activated"===t.state)n(e);else{if("redundant"!==t.state)return;r(O.create("sw-reg-redundant"))}t.removeEventListener("statechange",i)};t.addEventListener("statechange",i)})},t.prototype.getSWRegistration_=function(){var e=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch(function(e){throw O.create("failed-serviceworker-registration",{browserErrorMessage:e.message})}).then(function(t){return e.waitForRegistrationToActivate_(t).then(function(){return e.registrationToUse=t,t.update(),t})}))},t.prototype.getPublicVapidKey_=function(){return Object(k.__awaiter)(this,void 0,void 0,function(){return Object(k.__generator)(this,function(e){return this.publicVapidKeyToUse?[2,this.publicVapidKeyToUse]:[2,P]})})},t.prototype.setupSWMessageListener_=function(){var e=this;navigator.serviceWorker.addEventListener("message",function(t){if(t.data&&t.data[y.TYPE_OF_MSG]){var n=t.data;switch(n[y.TYPE_OF_MSG]){case I.PUSH_MSG_RECEIVED:case I.NOTIFICATION_CLICKED:var r=n[y.DATA];e.messageObserver&&e.messageObserver.next(r)}}},!1)},t}(D);!function(e){var t=function(e){if(!v())throw O.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new L(e):new W(e)},n={isSupported:v};e.INTERNAL.registerService("messaging",t,n)}(_.a)},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return p});var c=n(7),u=n(32),f=n(73),l=n(3),d=n(0),h=(n.n(d),{width:600,height:400}),p=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};o(this,e),this.data=r,this.url=t,this.options=Object.assign(h,n)}return s(e,[{key:"load",value:function(){var e=this,t=Object.assign(this.data,{promptType:"popup",parentHostname:encodeURIComponent(location.hostname)});if(null===this.options.top&&null===this.options.left){var n=this.getCenterPosition(this.options.width,this.options.height);this.options.top=n.top,this.options.left=n.left}return d.info("Opening a popup to ".concat(this.url," with POST data:"),t),this.popupWindow=this.openWindowViaPost(this.url,t,this.options),this.establishCrossOriginMessaging(),this.loadPromise={},this.loadPromise.promise=new Promise(function(t,n){e.loadPromise.resolver=t,e.loadPromise.rejector=n}),this.loadPromise.promise}},{key:"getCenterPosition",value:function(e,t){var n=void 0!==window.screenLeft?window.screenLeft:screen.left,r=void 0!==window.screenTop?window.screenTop:screen.top;return{left:(window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width)/2-e/2+n,top:(window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height)/2-t/2+r}}},{key:"openWindowViaPost",value:function(e,t,n){var r=document.createElement("form");r.action=e,r.method="POST",r.target="mtsdk-http-popup";var i=void 0!=window.screenLeft?window.screenLeft:screen.left,o=void 0!=window.screenTop?window.screenTop:screen.top,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,c=a/2-n.width/2+i,u=s/2-n.height/2+o,f=window.open("about:blank","mtsdk-http-popup","toolbar=0,status=0,menubar=0,scrollbars=0,resizable=0, width=".concat(n.width,", height=").concat(n.height,", top=").concat(u,", left=").concat(c));if(t)for(var l in t){var d=document.createElement("textarea");d.name=l,d.value="object"==typeof t[l]?JSON.stringify(t[l]):t[l],r.appendChild(d)}return r.style.display="none",document.body.appendChild(r),r.submit(),document.body.removeChild(r),f}},{key:"establishCrossOriginMessaging",value:function(){this.messenger=new c.a(this.popupWindow,this.url,this.url),this.messenger.on(c.a.POSTMAM_COMMANDS.POPUP_BEGIN_MESSAGEPORT_COMMS,this.onBeginMessagePortCommunications.bind(this)),this.messenger.once(c.a.POSTMAM_COMMANDS.POPUP_LOADED,this.onPopupLoaded.bind(this)),this.messenger.once(c.a.POSTMAM_COMMANDS.POPUP_ACCEPTED,this.onPopupAccepted.bind(this)),this.messenger.once(c.a.POSTMAM_COMMANDS.POPUP_REJECTED,this.onPopupRejected.bind(this)),this.messenger.once(c.a.POSTMAM_COMMANDS.POPUP_CLOSING,this.onPopupClosing.bind(this)),this.messenger.once(c.a.POSTMAM_COMMANDS.WINDOW_TIMEOUT,this.onWindowTimeout.bind(this)),this.messenger.on(c.a.POSTMAM_COMMANDS.REMOTE_NOTIFICATION_PERMISSION_CHANGED,this.onRemoteNotificationPermissionChanged.bind(this)),this.messenger.once(c.a.POSTMAM_COMMANDS.FINISH_REMOTE_REGISTRATION,this.onFinishingRegistrationRemotely.bind(this)),this.messenger.startPostMessageReceive()}},{key:"dispose",value:function(){this.messenger.destroy()}},{key:"onRemoteNotificationPermissionChanged",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:$mtsdk.trigger($mtsdk.EVENTS.NATIVE_PROMPT_PERMISSIONCHANGED,[t.data.permission]);case 1:case"end":return e.stop()}},e)}));return e}()},{key:"onBeginMessagePortCommunications",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.debug("(".concat(l.a.getWindowEnv(),") Successfully established cross-origin messaging with the popup window.")),this.messenger.connect(),e.abrupt("return",!1);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"onPopupLoaded",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.loadPromise.resolver(),u.a.trigger("popupLoad");case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"onPopupAccepted",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.warn("onPopupAccepted");case 1:case"end":return e.stop()}},e)}));return e}()},{key:"onPopupRejected",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.warn("onPopupRejected");case 1:case"end":return e.stop()}},e)}));return e}()},{key:"onPopupClosing",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.info("Popup window is closing, running cleanup events."),u.a.trigger($mtsdk.EVENTS.POPUP_CLOSING),this.dispose();case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"onWindowTimeout",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.debug(l.a.getWindowEnv()+" Popup window timed out and was closed."),u.a.trigger($mtsdk.EVENTS.POPUP_WINDOW_TIMEOUT);case 2:case"end":return e.stop()}},e)}));return e}()},{key:"onFinishingRegistrationRemotely",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d.debug(l.a.getWindowEnv()+" Finishing HTTP popup registration inside the iFrame, sent from popup."),t.reply({progress:!0}),this.messenger.stopPostMessageReceive(),e.next=5,f.a.registerWithBackend(t.data.subscriptionInfo);case 5:case"end":return e.stop()}},e,this)}));return e}()},{key:"message",value:function(){var e;(e=this.messenger).message.apply(e,arguments)}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return u});var c=n(0),u=(n.n(c),function(){function e(){o(this,e)}return s(e,null,[{key:"registerWithBackend",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$mtsdk.visitor.ready;case 2:if(n=e.sent,n.firebaseToken!==t.fcmToken&&t.fcmToken||n.subscriptionKey!==t.p256dh||n.subscriptionAuth!==t.auth||n.subscriptionEndpoint!==t.endpoint||n.vapidKey!==t.vapidKey){e.next=6;break}return c.debug("Subscription not changed no need to subscribe"),e.abrupt("return");case 6:n.setSubscriptionKey(t.p256dh),n.setSubscriptionAuth(t.auth),n.setSubscriptionEndpoint(t.endpoint),n.setFirebaseToken(t.fcmToken),n.setVapidKey(t.vapidKey),n.persist(),$mtsdk.trigger($mtsdk.EVENTS.SUBSCRIBE);case 13:case"end":return e.stop()}},e)}));return e}()}]),e}())},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return c});var a=n(75),s=n(13),c=function(){function e(t){r(this,e),this.prompt=null,this.manualPrompts={},this.nativePromptShown=!1,this.setPrompt(t),this.setManualPrompts(t)}return o(e,null,[{key:"TRIGGER",get:function(){return{MANUAL:"manual",AUTO:"auto"}}}]),o(e,[{key:"allow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};$mtsdk.trigger($mtsdk.EVENTS.PROMPT.ALLOW,[this.prompt,e])}},{key:"cancel",value:function(){this.block()}},{key:"display",value:function(){$mtsdk.trigger($mtsdk.EVENTS.PROMPT.DISPLAY,[this.prompt]),sessionStorage.setItem("MT_PROMPT_SHOWN",this.prompt.id)}},{key:"block",value:function(){sessionStorage.setItem("MT_PROMPT_BLOCKED",this.prompt.id),localStorage.setItem("MT_PROMPT_SHOWN_AT",Math.floor(Date.now()/1e3).toString())}},{key:"hasShown",value:function(){return!!sessionStorage.getItem("MT_PROMPT_SHOWN")}},{key:"shownId",value:function(){return sessionStorage.getItem("MT_PROMPT_SHOWN")}},{key:"isBlocked",value:function(){var e=parseFloat(localStorage.getItem("MT_PROMPT_SHOWN_AT"));return sessionStorage.getItem("MT_PROMPT_BLOCKED")||e>0&&Math.floor(Date.now()/1e3)-e<604800}},{key:"show",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.prompt;if(t&&!this.manualPrompts[t])return void console.warn("PromptManager: Error no manual trigger prompt with ID: ",t);if(t&&this.manualPrompts[t])this.prompt=this.manualPrompts[t];else if(!this.prompt||this.isBlocked())return;switch(this.display(),this.prompt.type){case"default":this.allow();break;case"2_step":var n=new a.a(this.prompt.body);$mtsdk.once(a.a.EVENTS.ALLOW_CLICK,function(t){e.allow(t),n.close()}),$mtsdk.once(a.a.EVENTS.CANCEL_CLICK,function(){e.cancel(),n.close()}),n.create()}}},{key:"getManualPrompt",value:function(e){return this.manualPrompts[e]||null}},{key:"setPrompt",value:function(t){Array.isArray(t)||(t=Object.values(t));var n;t=t.filter(function(t){return t.trigger===e.TRIGGER.AUTO}),s.a.isUsingSubscriptionWorkaround()&&(t=t.filter(function(e){return"default"!==e.type})),(n=sessionStorage.getItem("MT_PROMPT"))?n=JSON.parse(n):t.length>0?(n=t[Math.floor(Math.random()*t.length)],sessionStorage.setItem("MT_PROMPT",JSON.stringify(n))):$mtsdk.trigger($mtsdk.EVENTS.PROMPT.ALLOW,this.prompt),this.prompt=n}},{key:"setManualPrompts",value:function(t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];t[i].trigger===e.TRIGGER.MANUAL&&(this.manualPrompts[t[i].triggerId]=t[i])}}},{key:"hasManualPrompts",value:function(){return Object.keys(this.manualPrompts).length>0}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return d});var c=n(6),u=(n.n(c),n(76)),f=(n.n(u),n(32)),l=n(1),d=function(){function e(t){o(this,e),this.options=t}return s(e,null,[{key:"EVENTS",get:function(){return{ALLOW_CLICK:"popoverAllowClick",CANCEL_CLICK:"popoverCancelClick",SHOWN:"popoverShown",CLOSED:"popoverClosed"}}}]),s(e,[{key:"create",value:function(){function t(){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.container&&Object(l.j)("#mt-popover-container"),n='\n            <div id="normal-popover">\n                <div class="popover-body">\n                    <div class="popover-body-icon"><img src="'.concat(this.options.icon.src,'" alt="logo"></div>\n                    <div class="popover-body-title">').concat(this.options.title.text,'</div>\n                    <div class="popover-body-message">').concat(this.options.description.text,"</div>\n                    ").concat(this.getTraitsHTML(this.options),'\n                    <div class="clearfix"></div>\n                </div>\n                <div class="popover-footer">\n                    <button id="mt-popover-allow-button" class="align-right primary popover-button">\n                        ').concat(this.options.allowButton.text,'\n                    </button>\n                    <button id="mt-popover-cancel-button" class="align-right secondary popover-button">\n                        ').concat(this.options.closeButton.text,'\n                    </button>\n                    <div class="clearfix"></div>\n                </div>\n            </div>'),Object(l.b)("body","beforeend",'<div id="mt-popover-container" class="mt-popover-container mt-reset"></div>'),Object(l.b)(this.container,"beforeend",'<div id="mt-popover-dialog" class="mt-popover-dialog">'.concat(n,"</div>")),Object(l.a)(this.container,c.mobile?"slide-up":"slide-down"),this.allowButton.addEventListener("click",this.onPopoverAllowed.bind(this)),this.cancelButton.addEventListener("click",this.onPopoverCanceled.bind(this)),f.a.trigger(e.EVENTS.SHOWN);case 8:case"end":return t.stop()}},t,this)}));return t}()},{key:"getTraitsHTML",value:function(e){if(e.traits){var t="";return e.traits.forEach(function(e){t+='\n                    <div id="mt-checkbox" class="mt-checkbox">\n                        <input name="topic" value="'.concat(e.value,'" id="').concat(e.value,'" checked type="checkbox">\n                        <label id="mt-checkbox-label" for="').concat(e.value,'">').concat(e.label,"</label>\n                    </div>")}),'<div id="mt-popover-traits-container">'.concat(t,"</div>")}return""}},{key:"onPopoverAllowed",value:function(t){var n={},r=this.getCheckedTopics();r.length>0&&(n.traits={topics:r}),f.a.trigger(e.EVENTS.ALLOW_CLICK,n)}},{key:"onPopoverCanceled",value:function(t){f.a.trigger(e.EVENTS.CANCEL_CLICK)}},{key:"close",value:function(){var t=this;Object(l.a)(this.container,"close-popover"),Object(l.i)(this.dialog,"animationend",function(n,r){n.target!==t.dialog||"slideDownExit"!==n.animationName&&"slideUpExit"!==n.animationName||(Object(l.j)("#mt-popover-container"),r(),f.a.trigger(e.EVENTS.CLOSED))},!0)}},{key:"getCheckedTopics",value:function(){for(var e=document.querySelectorAll('input[name="topic"]:checked'),t=[],n=0;n<e.length;n++){var r=e[n].value;r?t.push(r):console.error("popover: Error topic without value")}return t}},{key:"container",get:function(){return document.querySelector("#mt-popover-container")}},{key:"dialog",get:function(){return document.querySelector("#mt-popover-dialog")}},{key:"allowButton",get:function(){return document.querySelector("#mt-popover-allow-button")}},{key:"cancelButton",get:function(){return document.querySelector("#mt-popover-cancel-button")}}]),e}()},function(e,t,n){"use strict";function r(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,c=r(e),u=1;u<arguments.length;u++){n=Object(arguments[u]);for(var f in n)o.call(n,f)&&(c[f]=n[f]);if(i){s=i(n);for(var l=0;l<s.length;l++)a.call(n,s[l])&&(c[s[l]]=n[s[l]])}}return c}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return u});var a=n(78),s={VALIDATE_FIRST:"You should call validate fn before.",VALIDATOR_ERROR:"Validator failed",INVALID_MAPPING_TYPE:"Invalid mapping type"},c={DATE:"date",ARRAY:"array",STRING:"string",NUMBER:"number"},u=function(){function e(){r(this,e),this._mappings=[],this._validateCalled=!1,this._errors=[],this._validTraits={}}return o(e,[{key:"setMappings",value:function(e){this._mappings=e}},{key:"validate",value:function(e){this._clear(),this._validateCalled=!0;for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t],i=this._validateField(r,e[r]),o=i.parsedField,a=i.error;if(a)this._errors.push(a);else{if(a||!o)throw new Error(s.VALIDATOR_ERROR);this._validTraits[r]=o}}}},{key:"getErrors",value:function(){if(!this._validateCalled)throw new Error(s.VALIDATE_FIRST);return this._errors}},{key:"getValid",value:function(){if(!this._validateCalled)throw new Error(s.VALIDATE_FIRST);return this._validTraits}},{key:"hasValidTraits",value:function(){if(!this._validateCalled)throw new Error(s.VALIDATE_FIRST);return Object.keys(this._validTraits).length>0}},{key:"hasErrors",value:function(){if(!this._validateCalled)throw new Error(s.VALIDATE_FIRST);return this._errors.length>0}},{key:"_validateField",value:function(e,t){var n=this._mappings.find(function(t){return t.field===e});if(!n)return{parsedField:null,error:"Trait field '".concat(e,"' not defined.")};var r=this._parseOrFail(n.type,t);return r?{parsedField:r,error:null}:{parsedField:null,error:"Invalid trait field '".concat(e,"' data type '").concat(n.type,"' is expected'.")}}},{key:"_parseOrFail",value:function(e,t){switch(e){case c.DATE:try{return Object(a.a)(t)}catch(e){return null}case c.ARRAY:return Array.isArray(t)?t:null;case c.STRING:return"string"==typeof t?t:null;case c.NUMBER:return"number"==typeof t?t:null;default:throw new Error(s.INVALID_MAPPING_TYPE)}}},{key:"_clear",value:function(){this._erorrs=[],this._validateCalled=!1}}]),e}()},function(e,t,n){"use strict";function r(e){var t=new Date;try{t=new Date(e)}catch(e){throw new Error("Invalid date")}return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())).toISOString()}t.a=r},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return d});var c=n(80),u=n(82),f=n.n(u),l=n(1),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o(this,e),this.storage=f.a.createInstance({name:"mxapis",storeName:"visitor"}),this.uid=t||c.a.get(),this.device=null,this.uid&&this.storage.setItem("uid",this.uid),this.ready=this.map()}return s(e,null,[{key:"EVENTS",get:function(){return{UPDATED:"visitor:updated"}}}]),s(e,[{key:"fetch",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.getItem("subscription_key");case 2:return e.t0=e.sent,e.next=5,this.storage.getItem("subscription_auth");case 5:return e.t1=e.sent,e.next=8,this.storage.getItem("subscription_endpoint");case 8:return e.t2=e.sent,e.next=11,this.storage.getItem("hide_badge");case 11:return e.t3=e.sent,e.next=14,this.storage.getItem("prompt");case 14:return e.t4=e.sent,e.next=17,this.storage.getItem("firebase_token");case 17:return e.t5=e.sent,e.next=20,this.storage.getItem("user_id");case 20:return e.t6=e.sent,e.next=23,this.storage.getItem("language");case 23:return e.t7=e.sent,e.next=26,this.storage.getItem("uid");case 26:return e.t8=e.sent,e.next=29,this.storage.getItem("tags");case 29:return e.t9=e.sent,e.next=32,this.storage.getItem("traits");case 32:return e.t10=e.sent,e.next=35,this.storage.getItem("last_activity");case 35:return e.t11=e.sent,e.next=38,this.storage.getItem("synced");case 38:return e.t12=e.sent,e.next=41,this.storage.getItem("notification_permission");case 41:return e.t13=e.sent,e.next=44,this.storage.getItem("safari_web_id");case 44:return e.t14=e.sent,e.next=47,this.storage.getItem("safari_device_token");case 47:return e.t15=e.sent,e.next=50,this.storage.getItem("vapid_key");case 50:return e.t16=e.sent,e.abrupt("return",{subscriptionKey:e.t0,subscriptionAuth:e.t1,subscriptionEndpoint:e.t2,hideBadge:e.t3,prompt:e.t4,firebaseToken:e.t5,userId:e.t6,language:e.t7,uid:e.t8,tags:e.t9,traits:e.t10,lastActivity:e.t11,synced:e.t12,notificationPermission:e.t13,safariWebId:e.t14,safariDeviceToken:e.t15,vapidKey:e.t16});case 52:case"end":return e.stop()}},e,this)}));return e}()},{key:"map",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch();case 2:return t=e.sent,this._synced=t.synced,this._userId=t.userId,this._language=t.language,this._tags=t.tags||new Set,this._traits=t.traits||{},this.subscriptionKey=t.subscriptionKey,this.subscriptionAuth=t.subscriptionAuth,this.subscriptionEndpoint=t.subscriptionEndpoint,this.badge=!t.hideBadge,this.prompt=t.prompt||0,this.firebaseToken=t.firebaseToken,this.uid=t.uid||this.uid,this.notificationPermission=t.notificationPermission,this.safariWebId=t.safariWebId,this.safariDeviceToken=t.safariDeviceToken,this.vapidKey=t.vapidKey,this.lastActivity=!t.lastActivity||Math.floor(((new Date).getTime()-new Date(t.lastActivity).getTime())/6e4)>=30?null:new Date(t.lastActivity),this.lastActivity||(this.setPrompt(0),this.showBadge()),e.next=23,this.storage.setItem("last_activity",(new Date).getTime());case 23:return e.abrupt("return",this);case 24:case"end":return e.stop()}},e,this)}));return e}()},{key:"setNotificationPermission",value:function(e){this.notificationPermission=e,this.storage.setItem("notification_permission",e)}},{key:"addTag",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=new Set(this.tags),r.add(e.sanitizeTag(n)),this.tags=r;case 3:case"end":return t.stop()}},t,this)}));return t}()},{key:"removeTag",value:function(){function t(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function t(n){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=new Set(this.tags),r.delete(e.sanitizeTag(n)),this.tags=r;case 3:case"end":return t.stop()}},t,this)}));return t}()},{key:"setTraits",value:function(e){var t=Object.assign({},this.traits,e);this.traits=t}},{key:"setDevice",value:function(e){this.device=e}},{key:"setWebsiteId",value:function(e){this.websiteId=e,this.storage.setItem("website_id",e)}},{key:"setVapidKey",value:function(e){this.vapidKey=e}},{key:"setSafariDeviceToken",value:function(e){this.safariDeviceToken=e}},{key:"setSafariWebId",value:function(e){this.safariWebId=e}},{key:"setFirebaseToken",value:function(e){e&&(this.firebaseToken=e)}},{key:"setSubscriptionKey",value:function(e){this.subscriptionKey=e}},{key:"setSubscriptionAuth",value:function(e){this.subscriptionAuth=e}},{key:"setSubscriptionEndpoint",value:function(e){this.subscriptionEndpoint=e}},{key:"persist",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.storage.setItem("uid",this.uid);case 2:return e.next=4,this.storage.setItem("website_id",this.websiteId);case 4:return e.next=6,this.storage.setItem("subscription_key",this.subscriptionKey);case 6:return e.next=8,this.storage.setItem("subscription_auth",this.subscriptionAuth);case 8:return e.next=10,this.storage.setItem("subscription_endpoint",this.subscriptionEndpoint);case 10:return e.next=12,this.storage.setItem("firebase_token",this.firebaseToken);case 12:return e.next=14,this.storage.setItem("safari_web_id",this.safariWebId);case 14:return e.next=16,this.storage.setItem("safari_device_token",this.safariDeviceToken);case 16:return e.next=18,this.storage.setItem("vapid_key",this.vapidKey);case 18:case"end":return e.stop()}},e,this)}));return e}()},{key:"setPrompt",value:function(e){this.prompt=e,this.storage.setItem("prompt",this.prompt)}},{key:"incrementPrompt",value:function(){this.setPrompt(this.prompt+1)}},{key:"hideBadge",value:function(){this.storage.setItem("hide_badge",1)}},{key:"showBadge",value:function(){this.badge=!0,this.storage.setItem("hide_badge",0)}},{key:"synced",set:function(e){this.storage.setItem("synced",e),this._synced=e},get:function(){return!1!==this._synced}},{key:"tags",set:function(t){l.k(t,this._tags)||(this._tags=new Set(t),this.storage.setItem("tags",this._tags),$mtsdk.emit(e.EVENTS.UPDATED,this))},get:function(){return new Set(this._tags||[])}},{key:"traits",set:function(t){l.h(t,this._traits)||(Object.assign(this._traits,t),this.storage.setItem("traits",this._traits),$mtsdk.emit(e.EVENTS.UPDATED,this))},get:function(){return this._traits}},{key:"userId",set:function(t){(t=t.toString().replace(/ /g,""))!==this._userId&&(this._userId=t,this.storage.setItem("user_id",t),$mtsdk.emit(e.EVENTS.UPDATED,this))},get:function(){return this._userId}},{key:"language",set:function(t){t!==this._language&&(this._language=t,this.storage.setItem("language",t),$mtsdk.emit(e.EVENTS.UPDATED,this))},get:function(){return this._language||window.navigator.language.slice(0,2)}}],[{key:"sanitizeTag",value:function(e){return e=e.toString().toLowerCase().replace(/[^\w\-]+/g,"").trim(),e.length>36&&(e=e.substr(0,36)),e.trim()}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return c});var a=n(81),s=n.n(a),c=function(){function e(){r(this,e)}return o(e,null,[{key:"get",value:function(){return s.a.get(e.GET_STORAGE_KEY)}},{key:"GET_STORAGE_KEY",get:function(){return"maxtu"}}]),e}()},function(e,t,n){var r;!function(i,o){"use strict";var a=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,r){return 1===arguments.length?t.get(e):t.set(e,n,r)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){t._cachedDocumentCookie!==t._document.cookie&&t._renewCache();var n=t._cache[t._cacheKeyPrefix+e];return void 0===n?void 0:decodeURIComponent(n)},t.set=function(e,n,r){return r=t._getExtendedOptions(r),r.expires=t._getExpiresDate(void 0===n?-1:r.expires),t._document.cookie=t._generateCookieString(e,n,r),t},t.expire=function(e,n){return t.set(e,void 0,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&void 0!==e.secure?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var r=e+"="+t;return r+=n.path?";path="+n.path:"",r+=n.domain?";domain="+n.domain:"",r+=n.expires?";expires="+n.expires.toUTCString():"",r+=n.secure?";secure":""},t._getCacheFromString=function(e){for(var n={},r=e?e.split("; "):[],i=0;i<r.length;i++){var o=t._getKeyValuePairFromCookieString(r[i]);void 0===n[t._cacheKeyPrefix+o.key]&&(n[t._cacheKeyPrefix+o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");t=t<0?e.length:t;var n,r=e.substr(0,t);try{n=decodeURIComponent(r)}catch(e){console&&"function"==typeof console.error&&console.error('Could not decode cookie with key "'+r+'"',e)}return{key:n,value:e.substr(t+1)}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="1"===t.set("cookies.js",1).get("cookies.js");return t.expire("cookies.js"),e},t.enabled=t._areEnabled(),t},s=i&&"object"==typeof i.document?a(i):a;void 0!==(r=function(){return s}.call(t,n,t,e))&&(e.exports=r)}("undefined"==typeof window?this:window)},function(e,t,n){(function(t){var n,n;!function(t){e.exports=t()}(function(){return function e(t,r,i){function o(s,c){if(!r[s]){if(!t[s]){var u="function"==typeof n&&n;if(!c&&u)return n(s,!0);if(a)return a(s,!0);var f=new Error("Cannot find module '"+s+"'");throw f.code="MODULE_NOT_FOUND",f}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n||e)},l,l.exports,e,t,r,i)}return r[s].exports}for(var a="function"==typeof n&&n,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,n,r){(function(e){"use strict";function t(){f=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}f=!1}function r(e){1!==l.push(e)||f||i()}var i,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var a=0,s=new o(t),c=e.document.createTextNode("");s.observe(c,{characterData:!0}),i=function(){c.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var n=e.document.createElement("script");n.onreadystatechange=function(){t(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n)}:function(){setTimeout(t,0)};else{var u=new e.MessageChannel;u.port1.onmessage=t,i=function(){u.port2.postMessage(0)}}var f,l=[];n.exports=r}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function r(){}function i(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=b,this.queue=[],this.outcome=void 0,e!==r&&c(this,e)}function o(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){p(function(){var r;try{r=t(n)}catch(t){return v.reject(e,t)}r===e?v.reject(e,new TypeError("Cannot resolve promise with itself")):v.resolve(e,r)})}function s(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function c(e,t){function n(t){o||(o=!0,v.reject(e,t))}function r(t){o||(o=!0,v.resolve(e,t))}function i(){t(r,n)}var o=!1,a=u(i);"error"===a.status&&n(a.value)}function u(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function f(e){return e instanceof this?e:v.resolve(new this(r),e)}function l(e){var t=new this(r);return v.reject(t,e)}function d(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=new Array(n),a=0,s=-1,c=new this(r);++s<n;)!function(e,r){function s(e){o[r]=e,++a!==n||i||(i=!0,v.resolve(c,o))}t.resolve(e).then(s,function(e){i||(i=!0,v.reject(c,e))})}(e[s],s);return c}function h(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var o=-1,a=new this(r);++o<n;)!function(e){t.resolve(e).then(function(e){i||(i=!0,v.resolve(a,e))},function(e){i||(i=!0,v.reject(a,e))})}(e[o]);return a}var p=e(1),v={},m=["REJECTED"],g=["FULFILLED"],b=["PENDING"];t.exports=i,i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){if("function"!=typeof e&&this.state===g||"function"!=typeof t&&this.state===m)return this;var n=new this.constructor(r);if(this.state!==b){a(n,this.state===g?e:t,this.outcome)}else this.queue.push(new o(n,e,t));return n},o.prototype.callFulfilled=function(e){v.resolve(this.promise,e)},o.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},o.prototype.callRejected=function(e){v.reject(this.promise,e)},o.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},v.resolve=function(e,t){var n=u(s,t);if("error"===n.status)return v.reject(e,n.value);var r=n.value;if(r)c(e,r);else{e.state=g,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},v.reject=function(e,t){e.state=m,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},i.resolve=f,i.reject=l,i.all=d,i.race=h},{1:1}],3:[function(e,n,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,i=0;i<e.length;i+=1)r.append(e[i]);return r.getBlob(t.type)}}function o(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function a(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function s(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function c(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function u(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function f(e){return new ge(function(t){var n=e.transaction(be,Se),r=i([""]);n.objectStore(be).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function l(e){return"boolean"==typeof ye?ge.resolve(ye):f(e).then(function(e){return ye=e})}function d(e){var t=we[e.name],n={};n.promise=new ge(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function h(e){var t=we[e.name],n=t.deferredOperations.pop();if(n)return n.resolve(),n.promise}function p(e,t){var n=we[e.name],r=n.deferredOperations.pop();if(r)return r.reject(t),r.promise}function v(e,t){return new ge(function(n,r){if(we[e.name]=we[e.name]||O(),e.db){if(!t)return n(e.db);d(e),e.db.close()}var i=[e.name];t&&i.push(e.version);var o=me.open.apply(me,i);t&&(o.onupgradeneeded=function(t){var n=o.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(be)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),o.onerror=function(e){e.preventDefault(),r(o.error)},o.onsuccess=function(){n(o.result),h(e)}})}function m(e){return v(e,!1)}function g(e){return v(e,!0)}function b(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||n){if(n){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function y(e){return new ge(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function w(e){return i([u(atob(e.data))],{type:e.type})}function _(e){return e&&e.__local_forage_encoded_blob}function k(e){var t=this,n=t._initReady().then(function(){var e=we[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return a(n,e,e),n}function S(e){d(e);for(var t=we[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,m(e).then(function(t){return e.db=t,b(e)?g(e):t}).then(function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r}).catch(function(t){throw p(e,t),t})}function E(e,t,n,r){void 0===r&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(i){if(r>0&&(!e.db||"InvalidStateError"===i.name||"NotFoundError"===i.name))return ge.resolve().then(function(){if(!e.db||"NotFoundError"===i.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),g(e)}).then(function(){return S(e).then(function(){E(e,t,n,r-1)})}).catch(n);n(i)}}function O(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function P(e){function t(){return ge.resolve()}var n=this,r={db:null};if(e)for(var i in e)r[i]=e[i];var o=we[r.name];o||(o=O(),we[r.name]=o),o.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=k);for(var a=[],s=0;s<o.forages.length;s++){var c=o.forages[s];c!==n&&a.push(c._initReady().catch(t))}var u=o.forages.slice(0);return ge.all(a).then(function(){return r.db=o.db,m(r)}).then(function(e){return r.db=e,b(r,n._defaultConfig.version)?g(r):e}).then(function(e){r.db=o.db=e,n._dbInfo=r;for(var t=0;t<u.length;t++){var i=u[t];i!==n&&(i._dbInfo.db=r.db,i._dbInfo.version=r.version)}})}function T(e,t){var n=this;e=s(e);var r=new ge(function(t,r){n.ready().then(function(){E(n._dbInfo,ke,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName),s=a.get(e);s.onsuccess=function(){var e=s.result;void 0===e&&(e=null),_(e)&&(e=w(e)),t(e)},s.onerror=function(){r(s.error)}}catch(e){r(e)}})}).catch(r)});return o(r,t),r}function I(e,t){var n=this,r=new ge(function(t,r){n.ready().then(function(){E(n._dbInfo,ke,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName),s=a.openCursor(),c=1;s.onsuccess=function(){var n=s.result;if(n){var r=n.value;_(r)&&(r=w(r));var i=e(r,n.key,c++);void 0!==i?t(i):n.continue()}else t()},s.onerror=function(){r(s.error)}}catch(e){r(e)}})}).catch(r)});return o(r,t),r}function N(e,t,n){var r=this;e=s(e);var i=new ge(function(n,i){var o;r.ready().then(function(){return o=r._dbInfo,"[object Blob]"===_e.call(t)?l(o.db).then(function(e){return e?t:y(t)}):t}).then(function(t){E(r._dbInfo,Se,function(o,a){if(o)return i(o);try{var s=a.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var c=s.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=c.error?c.error:c.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return o(i,n),i}function C(e,t){var n=this;e=s(e);var r=new ge(function(t,r){n.ready().then(function(){E(n._dbInfo,Se,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName),s=a.delete(e);o.oncomplete=function(){t()},o.onerror=function(){r(s.error)},o.onabort=function(){var e=s.error?s.error:s.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return o(r,t),r}function R(e){var t=this,n=new ge(function(e,n){t.ready().then(function(){E(t._dbInfo,Se,function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName),a=o.clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return o(n,e),n}function x(e){var t=this,n=new ge(function(e,n){t.ready().then(function(){E(t._dbInfo,ke,function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName),a=o.count();a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return o(n,e),n}function A(e,t){var n=this,r=new ge(function(t,r){if(e<0)return void t(null);n.ready().then(function(){E(n._dbInfo,ke,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName),s=!1,c=a.openCursor();c.onsuccess=function(){var n=c.result;if(!n)return void t(null);0===e?t(n.key):s?t(n.key):(s=!0,n.advance(e))},c.onerror=function(){r(c.error)}}catch(e){r(e)}})}).catch(r)});return o(r,t),r}function M(e){var t=this,n=new ge(function(e,n){t.ready().then(function(){E(t._dbInfo,ke,function(r,i){if(r)return n(r);try{var o=i.objectStore(t._dbInfo.storeName),a=o.openCursor(),s=[];a.onsuccess=function(){var t=a.result;if(!t)return void e(s);s.push(t.key),t.continue()},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return o(n,e),n}function j(e,t){t=c.apply(this,arguments);var n=this.config();e="function"!=typeof e&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;if(e.name){var a=e.name===n.name&&i._dbInfo.db,s=a?ge.resolve(i._dbInfo.db):m(e).then(function(t){var n=we[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t});r=e.storeName?s.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;d(e);var r=we[e.name],i=r.forages;t.close();for(var o=0;o<i.length;o++){var a=i[o];a._dbInfo.db=null,a._dbInfo.version=n}return new ge(function(t,r){var i=me.open(e.name,n);i.onerror=function(e){i.result.close(),r(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,h(n._dbInfo)}}).catch(function(t){throw(p(e,t)||ge.resolve()).catch(function(){}),t})}}):s.then(function(t){d(e);var n=we[e.name],r=n.forages;t.close();for(var i=0;i<r.length;i++){r[i]._dbInfo.db=null}return new ge(function(t,n){var r=me.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<r.length;t++)h(r[t]._dbInfo)}).catch(function(t){throw(p(e,t)||ge.resolve()).catch(function(){}),t})})}else r=ge.reject("Invalid arguments");return o(r,t),r}function D(e){var t,n,r,i,o,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var u=new ArrayBuffer(a),f=new Uint8Array(u);for(t=0;t<s;t+=4)n=Oe.indexOf(e[t]),r=Oe.indexOf(e[t+1]),i=Oe.indexOf(e[t+2]),o=Oe.indexOf(e[t+3]),f[c++]=n<<2|r>>4,f[c++]=(15&r)<<4|i>>2,f[c++]=(3&i)<<6|63&o;return u}function L(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=Oe[n[t]>>2],r+=Oe[(3&n[t])<<4|n[t+1]>>4],r+=Oe[(15&n[t+1])<<2|n[t+2]>>6],r+=Oe[63&n[t+2]];return n.length%3==2?r=r.substring(0,r.length-1)+"=":n.length%3==1&&(r=r.substring(0,r.length-2)+"=="),r}function W(e,t){var n="";if(e&&(n=Ve.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===Ve.call(e.buffer))){var r,i=Ie;e instanceof ArrayBuffer?(r=e,i+=Ce):(r=e.buffer,"[object Int8Array]"===n?i+=xe:"[object Uint8Array]"===n?i+=Ae:"[object Uint8ClampedArray]"===n?i+=Me:"[object Int16Array]"===n?i+=je:"[object Uint16Array]"===n?i+=Le:"[object Int32Array]"===n?i+=De:"[object Uint32Array]"===n?i+=We:"[object Float32Array]"===n?i+=Be:"[object Float64Array]"===n?i+=Ue:t(new Error("Failed to get type for BinaryArray"))),t(i+L(r))}else if("[object Blob]"===n){var o=new FileReader;o.onload=function(){var n=Pe+e.type+"~"+L(this.result);t(Ie+Re+n)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function B(e){if(e.substring(0,Ne)!==Ie)return JSON.parse(e);var t,n=e.substring(Fe),r=e.substring(Ne,Fe);if(r===Re&&Te.test(n)){var o=n.match(Te);t=o[1],n=n.substring(o[0].length)}var a=D(n);switch(r){case Ce:return a;case Re:return i([a],{type:t});case xe:return new Int8Array(a);case Ae:return new Uint8Array(a);case Me:return new Uint8ClampedArray(a);case je:return new Int16Array(a);case Le:return new Uint16Array(a);case De:return new Int32Array(a);case We:return new Uint32Array(a);case Be:return new Float32Array(a);case Ue:return new Float64Array(a);default:throw new Error("Unkown type: "+r)}}function U(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function F(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var i=new ge(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction(function(i){U(i,n,function(){t._dbInfo=n,e()},function(e,t){r(t)})},r)});return n.serializer=$e,i}function V(e,t,n,r,i,o){e.executeSql(n,r,i,function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,s){s.rows.length?o(e,a):U(e,t,function(){e.executeSql(n,r,i,o)},o)},o):o(e,a)},o)}function $(e,t){var n=this;e=s(e);var r=new ge(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){V(n,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=i.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function K(e,t){var n=this,r=new ge(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){V(n,i,"SELECT * FROM "+i.storeName,[],function(n,r){for(var o=r.rows,a=o.length,s=0;s<a;s++){var c=o.item(s),u=c.value;if(u&&(u=i.serializer.deserialize(u)),void 0!==(u=e(u,c.key,s+1)))return void t(u)}t()},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function G(e,t,n,r){var i=this;e=s(e);var a=new ge(function(o,a){i.ready().then(function(){void 0===t&&(t=null);var s=t,c=i._dbInfo;c.serializer.serialize(t,function(t,u){u?a(u):c.db.transaction(function(n){V(n,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){o(s)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void o(G.apply(i,[e,s,n,r-1]));a(t)}})})}).catch(a)});return o(a,n),a}function H(e,t,n){return G.apply(this,[e,t,n,1])}function z(e,t){var n=this;e=s(e);var r=new ge(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){V(n,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function q(e){var t=this,n=new ge(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){V(t,r,"DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return o(n,e),n}function Y(e){var t=this,n=new ge(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){V(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n}function J(e,t){var n=this,r=new ge(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){V(n,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return o(r,t),r}function Z(e){var t=this,n=new ge(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){V(t,r,"SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,t){n(t)})})}).catch(n)});return o(n,e),n}function X(e){return new ge(function(t,n){e.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).name);t({db:e,storeNames:i})},function(e,t){n(t)})},function(e){n(e)})})}function Q(e,t){t=c.apply(this,arguments);var n=this.config();e="function"!=typeof e&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,i=this;return r=e.name?new ge(function(t){var r;r=e.name===n.name?i._dbInfo.db:openDatabase(e.name,"","",0),t(e.storeName?{db:r,storeNames:[e.storeName]}:X(r))}).then(function(e){return new ge(function(t,n){e.db.transaction(function(r){for(var i=[],o=0,a=e.storeNames.length;o<a;o++)i.push(function(e){return new ge(function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){n(t)})})}(e.storeNames[o]));ge.all(i).then(function(){t()}).catch(function(e){n(e)})},function(e){n(e)})})}):ge.reject("Invalid arguments"),o(r,t),r}function ee(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function te(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}function ne(){return!te()||localStorage.length>0}function re(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=ee(e,t._defaultConfig),ne()?(t._dbInfo=n,n.serializer=$e,ge.resolve()):ge.reject()}function ie(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return o(n,e),n}function oe(e,t){var n=this;e=s(e);var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return o(r,t),r}function ae(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,o=localStorage.length,a=1,s=0;s<o;s++){var c=localStorage.key(s);if(0===c.indexOf(r)){var u=localStorage.getItem(c);if(u&&(u=t.serializer.deserialize(u)),void 0!==(u=e(u,c.substring(i),a++)))return u}}});return o(r,t),r}function se(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return o(r,t),r}function ce(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var o=localStorage.key(i);0===o.indexOf(e.keyPrefix)&&r.push(o.substring(e.keyPrefix.length))}return r});return o(n,e),n}function ue(e){var t=this,n=t.keys().then(function(e){return e.length});return o(n,e),n}function fe(e,t){var n=this;e=s(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return o(r,t),r}function le(e,t,n){var r=this;e=s(e);var i=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new ge(function(i,o){var a=r._dbInfo;a.serializer.serialize(t,function(t,r){if(r)o(r);else try{localStorage.setItem(a.keyPrefix+e,t),i(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}})})});return o(i,n),i}function de(e,t){if(t=c.apply(this,arguments),e="function"!=typeof e&&e||{},!e.name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,i=this;return r=e.name?new ge(function(t){t(e.storeName?ee(e,i._defaultConfig):e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):ge.reject("Invalid arguments"),o(r,t),r}function he(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function pe(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(qe(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();"undefined"==typeof Promise&&e(3);var ge=Promise,be="local-forage-detect-blob-support",ye=void 0,we={},_e=Object.prototype.toString,ke="readonly",Se="readwrite",Ee={_driver:"asyncStorage",_initStorage:P,_support:function(){try{if(!me)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:I,getItem:T,setItem:N,removeItem:C,clear:R,length:x,key:A,keys:M,dropInstance:j},Oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pe="~~local_forage_type~",Te=/^~~local_forage_type~([^~]+)~/,Ie="__lfsc__:",Ne=Ie.length,Ce="arbf",Re="blob",xe="si08",Ae="ui08",Me="uic8",je="si16",De="si32",Le="ur16",We="ui32",Be="fl32",Ue="fl64",Fe=Ne+Ce.length,Ve=Object.prototype.toString,$e={serialize:W,deserialize:B,stringToBuffer:D,bufferToString:L},Ke={_driver:"webSQLStorage",_initStorage:F,_support:function(){return"function"==typeof openDatabase}(),iterate:K,getItem:$,setItem:H,removeItem:z,clear:q,length:Y,key:J,keys:Z,dropInstance:Q},Ge={_driver:"localStorageWrapper",_initStorage:re,_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:ae,getItem:oe,setItem:le,removeItem:fe,clear:ie,length:ue,key:se,keys:ce,dropInstance:de},He=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},ze=function(e,t){for(var n=e.length,r=0;r<n;){if(He(e[r],t))return!0;r++}return!1},qe=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ye={},Je={},Ze={INDEXEDDB:Ee,WEBSQL:Ke,LOCALSTORAGE:Ge},Xe=[Ze.INDEXEDDB._driver,Ze.WEBSQL._driver,Ze.LOCALSTORAGE._driver],Qe=["dropInstance"],et=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Qe),tt={description:"",driver:Xe.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},nt=function(){function e(t){r(this,e);for(var n in Ze)if(Ze.hasOwnProperty(n)){var i=Ze[n],o=i._driver;this[n]=o,Ye[o]||this.defineDriver(i)}this._defaultConfig=pe({},tt),this._config=pe({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":ve(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new ge(function(t,n){try{var r=e._driver,i=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(i);for(var a=et.concat("_initStorage"),s=0,c=a.length;s<c;s++){var u=a[s];if((!ze(Qe,u)||e[u])&&"function"!=typeof e[u])return void n(i)}!function(){for(var t=0,n=Qe.length;t<n;t++){var r=Qe[t];e[r]||(e[r]=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=ge.reject(t);return o(n,arguments[arguments.length-1]),n}}(r))}}();var f=function(n){Ye[r]&&console.info("Redefining LocalForage driver: "+r),Ye[r]=e,Je[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(f,n):f(!!e._support):f(!0)}catch(e){n(e)}});return a(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Ye[e]?ge.resolve(Ye[e]):ge.reject(new Error("Driver not found."));return a(r,t,n),r},e.prototype.getSerializer=function(e){var t=ge.resolve($e);return a(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return a(n,e,e),n},e.prototype.setDriver=function(e,t,n){function r(){s._config.driver=s.driver()}function i(e){return s._extend(e),r(),s._ready=s._initStorage(s._config),s._ready}function o(e){return function(){function t(){for(;n<e.length;){var o=e[n];return n++,s._dbInfo=null,s._ready=null,s.getDriver(o).then(i).catch(t)}r();var a=new Error("No available storage method found.");return s._driverSet=ge.reject(a),s._driverSet}var n=0;return t()}}var s=this;qe(e)||(e=[e]);var c=this._getSupportedDrivers(e),u=null!==this._driverSet?this._driverSet.catch(function(){return ge.resolve()}):ge.resolve();return this._driverSet=u.then(function(){var e=c[0];return s._dbInfo=null,s._ready=null,s.getDriver(e).then(function(e){s._driver=e._driver,r(),s._wrapLibraryMethodsWithReady(),s._initDriver=o(c)})}).catch(function(){r();var e=new Error("No available storage method found.");return s._driverSet=ge.reject(e),s._driverSet}),a(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!Je[e]},e.prototype._extend=function(e){pe(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=et.length;e<t;e++)he(this,et[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),rt=new nt;t.exports=rt},{3:3}]},{},[4])(4)})}).call(t,n(11))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return a});var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;r(this,e),this.delay=t,this.timeout=null}return o(e,[{key:"listen",value:function(e,t){var n=this;$mtsdk.on(e,function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];window.clearTimeout(n.timeout),n.timeout=window.setTimeout(function(){t.call.apply(t,[null].concat(r)),n.timeout=null},n.delay)})}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return d});var c=n(85),u=n(87),f=n(0),l=(n.n(f),n(1)),d=function(){function e(t,n){o(this,e),this.websiteConfig=n,this.config=t.config,this.core=t,this.visitor=t.visitor,this.log={error:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){console.error(e,t)}),info:function(e,t){console.info(error,t)}},this.state=null,this.autoSubscribe=!1,this.websiteConfig.opt_in_enabled}return s(e,[{key:"create",value:function(){function e(){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.websiteConfig.opt_in_enabled){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._getServiceWorker();case 4:t=e.sent,$mtsdk.firebaseMessaging.useServiceWorker(t),this.serviceWorkerRegistration=t,this._setupUi(),this._stateChangeListener=this._stateChangeListener.bind(this),this._subscriptionUpdate=this._subscriptionUpdate.bind(this),this._client=new u.a(this._stateChangeListener,this._subscriptionUpdate);case 11:case"end":return e.stop()}},e,this)}));return e}()},{key:"_setupUi",value:function(){this.ui=new c.a({button_shape:this.websiteConfig.button_shape,backgroundColor:this.websiteConfig.background_color,icon_color:this.websiteConfig.icon_color,badge_background_color:this.websiteConfig.badge_background_color,badge_text_color:this.websiteConfig.badge_text_color,tooltip_background_color:this.websiteConfig.tooltip_background_color,tooltip_color:this.websiteConfig.tooltip_color,blocked_tooltip:this.websiteConfig.blocked_tooltip,subscribe_tooltip:this.websiteConfig.subscribe_tooltip,backdrop_color:this.websiteConfig.backdrop_color,info_background_color:this.websiteConfig.info_background_color,info_color:this.websiteConfig.info_color,info_title:this.websiteConfig.info_title,info_text:this.websiteConfig.info_text,buttonClick:this._onButtonClick.bind(this),buttonMouseover:this._onButtonMouseover.bind(this),css_url:this.config.push.css_url,assets_url:this.config.api.assets_url,blocked_button_position:this.websiteConfig.blocked_button_position,domain:this.core.domain,branding:this.config.push.push_branding})}},{key:"_onButtonClick",value:function(e){"PERMISSION_PROMPT"==this.state.id&&this._client.subscribeDevice(),"PERMISSION_DENIED"==this.state.id&&this.ui.toggleDialog(),e.stopPropagation()}},{key:"_onButtonMouseover",value:function(e){"PERMISSION_PROMPT"==this.state.id&&(this.ui.setMessage(this.websiteConfig.subscribe_tooltip),this.ui.showMessage(),this.visitor.hideBadge()),"PERMISSION_DENIED"==this.state.id&&(this.ui.setMessage(this.websiteConfig.blocked_tooltip),this.ui.showMessage())}},{key:"_getServiceWorker",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return navigator.serviceWorker.getRegistration().then(function(n){if(void 0===n)return e._registerServiceWorker();if(n.active){return n.active.scriptURL.includes(e.config.worker)&&!t?e._registerServiceWorker():n.unregister().then(function(t){return e._registerServiceWorker()})}return null===n.installing?e._registerServiceWorker():void 0})}},{key:"_registerServiceWorker",value:function(){var e=this;return new Promise(function(t,n){navigator.serviceWorker.register(e.config.worker,{scope:e.config.worker_options.scope}).then(function(e){t(e)}).catch(function(e){n(Error("Unable to Register SW : "+e))})})}},{key:"_stateChangeListener",value:function(e,t){var n=this;switch(this.state=e,this.ui.setInteractive(e.interactive),(e.enabled&&"auto"!=this.websiteConfig.opt_in_type||"auto"==this.websiteConfig.opt_in_type&&"PERMISSION_DENIED"==e.id&&this.websiteConfig.blocked_state_enabled)&&"phone"!=this.visitor.device?this.ui.show():this.ui.hide(),e.id){case"PERMISSION_PROMPT":this.visitor.badge&&this.ui.showBadge();break;case"STARTING_SUBSCRIBE":this.visitor.incrementPrompt();break;case"ERROR":this.log.error("Ooops a Problem Occurred",t)}e.id,this._client&&"auto"===this.websiteConfig.opt_in_type&&"PERMISSION_PROMPT"===e.id&&!this.autoSubscribe&&(this.autoSubscribe=!0,$mtsdk.once($mtsdk.EVENTS.PROMPT.ALLOW,function(){n._client.subscribeDevice()}),$mtsdk.promptManager.show())}},{key:"_subscriptionUpdate",value:function(e){var t=this;if(!e){if(null==this.visitor.subscriptionKey&&null==this.visitor.subscriptionAuth&&null==this.visitor.subscriptionEndpoint)return;return this.visitor.setSubscriptionKey(null),this.visitor.setSubscriptionAuth(null),this.visitor.setSubscriptionEndpoint(null),this.visitor.persist(),void $mtsdk.trigger($mtsdk.EVENTS.UNSUBSCRIBE)}var n=e.getKey?btoa(String.fromCharCode.apply(null,new Uint8Array(e.getKey("p256dh")))):"",r=e.getKey?btoa(String.fromCharCode.apply(null,new Uint8Array(e.getKey("auth")))):"",i=$mtsdk.website.vapid_key;this._getFirebaseToken().then(function(o){return new Promise(function(a,s){t.visitor.firebaseToken!=o&&o||t.visitor.subscriptionKey!=n||t.visitor.subscriptionAuth!=r||t.visitor.subscriptionEndpoint!=e.endpoint||t.visitor.vapidKey!=i||s(),t.visitor.setSubscriptionKey(n),t.visitor.setSubscriptionAuth(r),t.visitor.setSubscriptionEndpoint(e.endpoint),t.visitor.setFirebaseToken(o),t.visitor.setVapidKey(i),a()})}).then(function(){t.visitor.persist(),$mtsdk.trigger($mtsdk.EVENTS.SUBSCRIBE)}).catch(function(e){return console.log})}},{key:"_getFirebaseToken",value:function(){var e=this;return new Promise(function(t){return $mtsdk.firebaseMessaging.getToken().then(function(e){t(e)}).catch(function(){var n=i(regeneratorRuntime.mark(function n(r){var i,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(f.debug(r.message),"messaging/token-subscribe-failed"!==r.code){n.next=12;break}return n.next=4,e._getServiceWorker(!0);case 4:return i=n.sent,$mtsdk.firebaseMessaging=l.d('mt-firebase-app"-'+Math.floor(Date.now()/1e3)),$mtsdk.firebaseMessaging.useServiceWorker(i),e.serviceWorkerRegistration=i,n.next=10,$mtsdk.firebaseMessaging.getToken();case 10:o=n.sent,t(o);case 12:t(null);case 13:case"end":return n.stop()}},n)}));return function(e){return n.apply(this,arguments)}}())})}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return s});var a=n(86),s=function(){function e(t){var n=this;r(this,e),this.state=null,this.config=t,this.badgeShown=!1,this.dom=a.a,this.interactive=!1,this.container=this.dom("<div>").css("display","block").addClass("mt-push-container").addClass(this.config.blocked_button_position).addClass("mt-reset").appendTo("body"),this.backdrop=null,this.launcher=this.dom("<div>").addClass("mt-push-launcher").appendTo(this.container),this.button=this.dom("<div>").addClass("mt-push-launcher-button").addClass(t.button_shape).css("background-color",t.backgroundColor).css("color",t.icon_color).html('<svg width="50" height="50" viewBox="0 0 1024 1024"><path d="M816.512 103.712h-609.056c-86.016 0-156 69.984-156 156v421.696c0 86.016 69.984 156 156 156h157.568l146.944 146.944 146.976-146.944h157.568c86.016 0 156-70.016 156-156v-421.728c0-86.016-70.016-155.968-156-155.968zM816.512 759.616h-189.568l-114.976 115.008-114.944-115.008h-189.568c-43.168 0-78.272-35.136-78.272-78.24v-421.696c0-43.136 35.136-78.24 78.272-78.24h609.056c43.2 0 78.272 35.104 78.272 78.24v421.696c0.032 43.136-35.104 78.24-78.272 78.24z"></path></svg>').appendTo(this.launcher),this.badge=this.dom("<div>").addClass("mt-push-launcher-badge").css("background-color",t.badge_background_color).css("color",t.badge_text_color).css("border-color",t.badge_text_color).html(1).appendTo(this.launcher),this.message=this.dom("<div>").addClass("mt-push-launcher-message").addClass(this.config.blocked_button_position).css("background-color",t.tooltip_background_color).css("color",t.tooltip_background_color).appendTo(this.launcher),this.messageBody=this.dom("<div>").addClass("mt-push-launcher-message-body").css("color",t.tooltip_color).appendTo(this.message),this.dialog=this.dom("<div>").addClass("mt-push-launcher-dialog").css("background-color",t.info_background_color).addClass(this.config.blocked_button_position).css("color",t.info_background_color).appendTo(this.launcher),this.dialogBody=this.dom("<div>").addClass("mt-push-launcher-dialog-body").css("color",t.info_color).html('<div class="title">'+t.info_title+'</div><div class="divider"></div><p>'+t.info_text+'</p><video class="unblock-video" type="video/mp4" autoplay loop><div class="instructions"></div></video>').appendTo(this.dialog),this.button.on("mouseover",function(e){if(!n.interactive)return!1;n.hideBadge(),t.buttonMouseover(e)}),this.button.on("mouseout",function(e){n.hideMessage()}),this.button.on("click",function(e){if(!n.interactive)return!1;t.buttonClick(e)}),this.dom("body").on("click",function(e){n.dialog.removeClass("opened")}),this.hideBranding()}return o(e,[{key:"setInteractive",value:function(e){this.interactive=e}},{key:"show",value:function(){var e=this;setTimeout(function(){e.launcher.addClass("opened")},100)}},{key:"hide",value:function(){var e=this;setTimeout(function(){e.launcher.removeClass("opened")},100)}},{key:"toggleDialog",value:function(){this.dialog.toggleClass("opened"),this.dialog.hasClass("opened")&&this.dom(".unblock-video").attr("src","".concat(this.config.assets_url,"/img/push/15fps.mp4"))}},{key:"showBadge",value:function(){var e=this;this.badgeShown||(this.badgeShown=!0,setTimeout(function(){e.badge.addClass("opened")},500))}},{key:"hideBadge",value:function(){var e=this;setTimeout(function(){e.badge.removeClass("opened")},100)}},{key:"setMessage",value:function(e){this.messageBody.html(e)}},{key:"showMessage",value:function(){var e=this;setTimeout(function(){e.message.addClass("opened")},100)}},{key:"hideMessage",value:function(){var e=this;setTimeout(function(){e.message.removeClass("opened")},100)}},{key:"showBackdrop",value:function(){this.backdrop=this.dom("<div>").addClass("mt-push-backdrop").addClass("in").css("background-color",this.config.backdrop_color).appendTo("body")}},{key:"hideBackdrop",value:function(){this.backdrop&&(this.backdrop.remove(),this.backdrop=null)}},{key:"hideBranding",value:function(){1!=this.config.branding&&(this.domainContainer=this.dom("<div>").addClass("push-branding").html(this.config.domain).appendTo(this.dialogBody))}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}var a=function(){function e(t){return r(this,e),this.makeArray(this.find(t)),this}return o(e,[{key:"find",value:function(e){var t=[];return e.nodeType&&(t[0]=e[0]),"string"==typeof e&&("<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?t[0]=this.create(e):t=document.querySelectorAll(e)),t}},{key:"makeArray",value:function(e){for(var t=0;t<e.length;t++)this[t]=e[t];this.length=e.length,this.nodeType=1==e.length?this[0].nodeType:0}},{key:"create",value:function(e){var t=e.substring(1,e.length-1);return document.createElement(t)}},{key:"html",value:function(e){return this.each(function(){this.innerHTML=e}),this}},{key:"each",value:function(e){for(var t=0,n=Array.from(this);t<n.length;t++){var r=n[t];e.call(r)}return this}},{key:"attr",value:function(e,t){return this.each(function(){this.setAttribute(e,t)})}},{key:"css",value:function(e,t){return this.each(function(){this.style[e]=t})}},{key:"toggleClass",value:function(e){return this.each(function(){this.classList.contains(e)?this.classList.remove(e):this.classList.add(e)})}},{key:"addClass",value:function(e){return this.each(function(){this.classList.add(e)})}},{key:"removeClass",value:function(e){return this.each(function(){this.classList.remove(e)})}},{key:"hasClass",value:function(e){return this[0].classList.contains(e)}},{key:"appendTo",value:function(e){for(var t=this,n=this.find(e),r=0,i=Array.from(n);r<i.length;r++)!function(){var e=i[r];t.each(function(){e.appendChild(this)})}();return this}},{key:"hide",value:function(){return this.each(function(){this.style.display="none"}),this}},{key:"show",value:function(){return this.each(function(){this.style.display="block"}),this}},{key:"remove",value:function(){return this.each(function(){this.parentNode.removeChild(this)}),this}},{key:"on",value:function(e,t){return this.each(function(){this.addEventListener(e,t,!1)})}}]),e}(),s=function(e){return new a(e)};t.a=s},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}n.d(t,"a",function(){return c});var c=function(){function e(t,n){var r=this;return o(this,e),this._stateChangeCb=t,this._subscriptionUpdate=n,this._state={UNSUPPORTED:{id:"UNSUPPORTED",interactive:!1,enabled:!1},INITIALISING:{id:"INITIALISING",interactive:!1,enabled:!1},PERMISSION_DENIED:{id:"PERMISSION_DENIED",interactive:!0,enabled:!0},PERMISSION_GRANTED:{id:"PERMISSION_GRANTED",interactive:!1,enabled:!1},PERMISSION_PROMPT:{id:"PERMISSION_PROMPT",interactive:!0,enabled:!0},ERROR:{id:"ERROR",interactive:!1,enabled:!1},STARTING_SUBSCRIBE:{id:"STARTING_SUBSCRIBE",interactive:!1,enabled:!0},SUBSCRIBED:{id:"SUBSCRIBED",interactive:!1,enabled:!1},STARTING_UNSUBSCRIBE:{id:"STARTING_UNSUBSCRIBE",interactive:!1,enabled:!0},UNSUBSCRIBED:{id:"UNSUBSCRIBED",interactive:!0,enabled:!0}},"serviceWorker"in navigator&&"PushManager"in window&&"showNotification"in ServiceWorkerRegistration.prototype?void navigator.serviceWorker.ready.then(function(){r._stateChangeCb(r._state.INITIALISING),r.setUpPushPermission()}):void this._stateChangeCb(this._state.UNSUPPORTED)}return s(e,[{key:"_permissionStateChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];switch(e){case"denied":this._stateChangeCb(this._state.PERMISSION_DENIED,{onChange:t}),this._subscriptionUpdate(null);break;case"granted":this._stateChangeCb(this._state.PERMISSION_GRANTED);break;case"default":case"prompt":this._stateChangeCb(this._state.PERMISSION_PROMPT),this._subscriptionUpdate(null);break;default:console.error("Unexpected permission state: ",e)}$mtsdk.trigger($mtsdk.EVENTS.NATIVE_PROMPT_PERMISSIONCHANGED,[e])}},{key:"setUpPushPermission",value:function(){var e=this;return this._permissionStateChange(window.Notification.permission),navigator.permissions&&navigator.permissions.query({name:"notifications"}).then(function(t){t.onchange=function(t){e._permissionStateChange(t.target.state,!0)}}),navigator.serviceWorker.ready.then(function(){var e=i(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.pushManager.getSubscription();case 2:if(!(n=e.sent)||$mtsdk.visitor.vapidKey==$mtsdk.website.vapid_key){e.next=6;break}return e.next=6,n.unsubscribe();case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).then(function(e){return e.pushManager.getSubscription()}).then(function(t){if(!t)return void("granted"===Notification.permission?e.subscribeDevice(!0):e._subscriptionUpdate(t));e._stateChangeCb(e._state.SUBSCRIBED),e._subscriptionUpdate(t)}).catch(function(t){e._stateChangeCb(e._state.ERROR,t)})}},{key:"subscribeDevice",value:function(e){var t=this;return void 0===e&&(e=!1),e||this._stateChangeCb(this._state.STARTING_SUBSCRIBE),$mtsdk.firebaseMessaging.requestPermission().then(function(){return $mtsdk.firebaseMessaging.getToken()}).then(function(){return navigator.serviceWorker.ready.then(function(e){return e.pushManager.getSubscription()}).then(function(e){t._stateChangeCb(t._state.SUBSCRIBED),t._subscriptionUpdate(e)}).catch(function(e){t._stateChangeCb(t._state.ERROR,e)})}).catch(function(){t._permissionStateChange(Notification.permission)})}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i});var r=["aa","ab","ae","af","ak","am","an","ar","as","av","ay","az","ba","be","bg","bh","bi","bm","bn","bo","br","bs","ca","ce","ch","co","cr","cs","cu","cv","cy","da","de","dv","dz","ee","el","en","eo","es","et","eu","fa","ff","fi","fj","fo","fr","fy","ga","gd","gl","gn","gu","gv","ha","he","hi","ho","hr","ht","hu","hy","hz","ia","id","ie","ig","ii","ik","io","is","it","iu","ja","jv","ka","kg","ki","kj","kk","kl","km","kn","ko","kr","ks","ku","kv","kw","ky","la","lb","lg","li","ln","lo","lt","lu","lv","mg","mh","mi","mk","ml","mn","mr","ms","mt","my","na","nb","nd","ne","ng","nl","nn","no","nr","nv","ny","oc","oj","om","or","os","pa","pi","pl","ps","pt","qu","rm","rn","ro","ru","rw","sa","sc","sd","se","sg","si","sk","sl","sm","sn","so","sq","sr","ss","st","su","sv","sw","ta","te","tg","th","ti","tk","tl","tn","to","tr","ts","tt","tw","ty","ug","uk","ur","uz","ve","vi","vo","wa","wo","xh","yi","yo","za","zh","zu"],i=function(e){return r.includes(e)}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return a});var a=function(){function e(t){r(this,e),this.creatives={},this.setCreatives(t)}return o(e,null,[{key:"DEFAULT_LANUAGE",get:function(){return"en"}}]),o(e,[{key:"setCreatives",value:function(e){var t=this;e.forEach(function(e){t.creatives[Object.keys(e)[0]]=new Object,t.creatives[Object.keys(e)[0]]=e[Object.keys(e)[0]]})}},{key:"getNotification",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t){var n=t!==e.DEFAULT_LANUAGE&&this.creatives[t];if(n)return this.creatives[n]}return this.creatives[e.DEFAULT_LANUAGE]}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return a});var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.bowser=t}return o(e,[{key:"browserType",value:function(){switch(!0){case this.bowser.safari:return"safari";case this.bowser.firefox:return"firefox";case this.bowser.msedge:return"edge";case this.bowser.chrome:return"chrome";default:throw new Error("PromptTargeter: Unsupported browser type")}}},{key:"filter",value:function(e){var t=this;return e||(e=[]),Array.isArray(e)||(e=Object.values(e)),e.filter(function(e){return e.targeting.includes(t.browserType())})}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return c});var a=n(0),s=n.n(a),c=function(){function e(t,n){r(this,e),this.core=n;var i=this;t.forEach(function(e){i.handle(e)})}return o(e,[{key:"handle",value:function(e){e=Array.prototype.slice.call(e);var t=e.shift();try{this.core[t].apply(this.core,e).catch(function(t){s.a.warn(t.message,e),s.a.debug(t)})}catch(n){s.a.error(t,e,n)}}}]),e}()},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n.d(t,"a",function(){return p});var a=n(2),s=n(0),c=(n.n(s),n(28)),u=n.n(c),f=n(33),l=n(93),d=n(14),h=n(1),p=function(){function e(){var t=this;r(this,e),this._event=new u.a,this.resourceLoader=new f.a,this.website={},this._pushNotificationPermission="unsupported",this._setCollectors(),s.setDefaultLevel(s.levels.WARN),this.loaded=new Promise(function(e){t.once(t.EVENTS.SDK_INITIALIZED,function(){s.debug("Mtsdk initialized"),e()})})}return o(e,[{key:"reload",value:function(){}},{key:"togglePushNotificationBlockedDialog",value:function(){this.pushNotifications&&"PERMISSION_DENIED"===this.pushNotifications.state.id&&this.pushNotifications.ui.toggleDialog()}},{key:"_setCollectors",value:function(){var e=this;this.on(this.EVENTS.SDK_INITIALIZED,function(){l.a.collect(l.a.action.pageview)}),this.on(this.EVENTS.SUBSCRIBE,function(){l.a.collect(l.a.action.subscribe)}),this.on(this.EVENTS.UNSUBSCRIBE,function(){l.a.collect(l.a.action.unsubscribe)}),this.on(this.EVENTS.PROMPT.DISPLAY,function(){e.promptManager.hasShown()||l.a.collect(l.a.action.prompt)}),this.on(this.EVENTS.NATIVE_PROMPT_PERMISSIONCHANGED,function(t){s.debug("Permission state change",t),$mtsdk.visitor.setNotificationPermission(t),e.pushNotificationPermission!==t&&(e._pushNotificationPermission=t,t===d.b&&e.promptManager.hasShown()&&l.a.collect(l.a.action.block))})}},{key:"showNotification",value:function(e,t){if(this._pushNotificationPermission==d.c)return Object(h.l)(e,t)}},{key:"on",value:function(){var e;return(e=this._event).on.apply(e,arguments)}},{key:"off",value:function(){var e;return(e=this._event).off.apply(e,arguments)}},{key:"once",value:function(){var e;return(e=this._event).once.apply(e,arguments)}},{key:"trigger",value:function(){var e;return(e=this._event).trigger.apply(e,arguments)}},{key:"emit",value:function(){var e;return(e=this._event).emit.apply(e,arguments)}},{key:"config",get:function(){return a.a}},{key:"EVENTS",get:function(){return{NATIVE_PROMPT_PERMISSIONCHANGED:"notificationPermissionChange",SUBSCRIPTION_CHANGED:"subscriptionChange",SDK_INITIALIZED:"initialize",SUBSCRIBE:"register",UNSUBSCRIBE:"unsubscribe",POPUP_CLOSING:"popupClose",PERMISSION_PROMPT_DISPLAYED:"permissionPromptDisplay",POPUP_WINDOW_TIMEOUT:"popupWindowTimeout",PROMPT:{DISPLAY:"promptDisplay",ALLOW:"promptAllow",CLOSE:"promptClose"}}}},{key:"visitorId",get:function(){return $mtsdk.visitor.uid}},{key:"pushNotificationPermission",get:function(){return this._pushNotificationPermission}},{key:"debug",set:function(e){e?s.setLevel(s.levels.TRACE):s.setLevel(s.levels.WARN)}}]),e}()},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,o){function a(e){r(c,i,o,a,s,"next",e)}function s(e){r(c,i,o,a,s,"throw",e)}var c=e.apply(t,n);a(void 0)})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function c(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?u(e):t}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.d(t,"a",function(){return v});var h=n(26),p=n(0),v=(n.n(p),function(e){function t(){return o(this,t),c(this,f(t).apply(this,arguments))}return l(t,e),s(t,null,[{key:"collect",value:function(){function e(e){return n.apply(this,arguments)}var n=i(regeneratorRuntime.mark(function e(n){var r,i,o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$mtsdk.visitor.ready;case 2:r=e.sent,i={t:n,uid:r.uid,wid:r.websiteId,device:r.device},e.t0=n,e.next=e.t0===t.action.pageview?7:e.t0===t.action.prompt?10:e.t0===t.action.block?10:e.t0===t.action.subscribe?12:17;break;case 7:return i.uri=encodeURIComponent(window.location.href),i.iswps=r.firebaseToken||r.safariDeviceToken?1:0,e.abrupt("break",17);case 10:return i.pid=$mtsdk.promptManager.prompt.id,e.abrupt("break",17);case 12:return r.firebaseToken?(i.ft=r.firebaseToken,o=194501636895,i.wps=encodeURIComponent(JSON.stringify({sender_id:o,endpoint:r.subscriptionEndpoint,auth:r.subscriptionAuth,p256dh:r.subscriptionKey,vapid_key:r.vapidKey,timestamp:Date.now()}))):r.safariDeviceToken&&(i.swps=encodeURIComponent(JSON.stringify({web_id:r.safariWebId,token:r.safariDeviceToken,timestamp:Date.now()}))),$mtsdk.promptManager.hasShown()?i.pid=$mtsdk.promptManager.shownId():i.snt=!0,i.lang=r.language,$mtsdk.website.automation&&!i.snt&&window.mt("track","webpush:subscribe"),e.abrupt("break",17);case 17:return a=t.buildUrl(i),e.prev=18,e.next=21,fetch(a);case 21:if(s=e.sent,200===s.status){e.next=25;break}return p.warn("Could not collect event ".concat(n,". Status Code: ").concat(s.status)),e.abrupt("return");case 25:p.debug("Event ".concat(n," collected successfully"),a),e.next=31;break;case 28:e.prev=28,e.t1=e.catch(18),p.debug("Error collecting event ".concat(n,": ").concat(e.t1.message));case 31:case"end":return e.stop()}},e,null,[[18,28]])}));return e}()},{key:"action",get:function(){return{prompt:"prompt",block:"block",subscribe:"subscribe",unsubscribe:"unsubscribe",pageview:"pageview"}}}]),t}(h.a))}]);